<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Learning Complete - AEC Games</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
        }
        #root {
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 2rem;
            margin: 1rem 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 2rem;
        }
        .title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .subtitle {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        .chapter-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #333;
        }
        .chapter-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        .chapter-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .chapter-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .chapter-subtitle {
            font-size: 1rem;
            margin-bottom: 1rem;
            opacity: 0.8;
        }
        .chapter-desc {
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        .btn:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
            transform: scale(1.05);
        }
        .btn-secondary {
            background: #666;
        }
        .btn-secondary:hover {
            background: #555;
        }
        .learning-card {
            text-align: center;
            padding: 2rem;
        }
        .word-display {
            font-size: 4rem;
            font-weight: bold;
            color: #667eea;
            margin: 1rem 0;
        }
        .pinyin {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 2rem;
        }
        .explanation {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid #667eea;
        }
        .game-card {
            padding: 2rem;
        }
        .question {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        .question-english {
            font-size: 1rem;
            color: #666;
        }
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        .option-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .option-btn:hover {
            background: #764ba2;
            transform: scale(1.02);
        }
        .reading-card {
            padding: 2rem;
        }
        .story-container {
            background: #fffbf0;
            padding: 2rem;
            border-radius: 15px;
            border-left: 4px solid #ffd700;
            margin: 2rem 0;
        }
        .sentence {
            font-size: 1.1rem;
            line-height: 1.8;
            margin: 1rem 0;
            padding: 0.5rem;
            border-radius: 5px;
        }
        .current-sentence {
            background: #fff3cd;
            border: 2px solid #ffc107;
            font-weight: bold;
            color: #856404;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        .back-btn {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: #666;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
        }
        .progress {
            text-align: center;
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 2rem;
        }
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .title { font-size: 2rem; }
            .word-display { font-size: 3rem; }
            .grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { BookOpen, Play, Volume2, RotateCcw, Gamepad2, Speaker, Home, ArrowLeft } = lucide;

        const ChineseLearningCompleteApp = () => {
          const [currentChapter, setCurrentChapter] = useState('menu');
          const [currentPhase, setCurrentPhase] = useState('learning');
          const [currentWordIndex, setCurrentWordIndex] = useState(0);
          const [viewedChinese, setViewedChinese] = useState(false);
          const [viewedEnglish, setViewedEnglish] = useState(false);
          const [gameAnswers, setGameAnswers] = useState({});
          const [wrongCount, setWrongCount] = useState(0);
          const [currentQuestion, setCurrentQuestion] = useState(0);
          const [gameCompleted, setGameCompleted] = useState(false);
          const [readingLanguage, setReadingLanguage] = useState('');
          const [currentSentence, setCurrentSentence] = useState(-1);
          const [isReading, setIsReading] = useState(false);

          // ç¬¬ä¸€ç¯‡æ•°æ®
          const chapter1Data = {
            vocabulary: [
              { word: 'åŠæ³•', pinyin: 'bÃ n fÇ', chinese: 'å¤„ç†äº‹æƒ…æˆ–è§£å†³é—®é¢˜çš„æ–¹æ³•', english: 'way; method; solution' },
              { word: 'è„‘ç­‹', pinyin: 'nÇo jÄ«n', chinese: 'æ€ç»´å’Œç†è§£èƒ½åŠ›ï¼›æƒ³æ³•', english: 'brain; mind; ideas' },
              { word: 'æµ®', pinyin: 'fÃº', chinese: 'æ¼‚åœ¨æ°´é¢ä¸Šï¼Œä¸ä¸‹æ²‰', english: 'to float' },
              { word: 'æ ‘æ´', pinyin: 'shÃ¹ dÃ²ng', chinese: 'æ ‘å¹²ä¸Šçš„ç©ºæ´', english: 'tree hollow' },
              { word: 'ç€æ€¥', pinyin: 'zhÃ¡o jÃ­', chinese: 'å¿ƒé‡Œç´§å¼ ï¼Œä¸å®‰', english: 'anxious; worried' },
              { word: 'æƒ…å½¢', pinyin: 'qÃ­ng xÃ­ng', chinese: 'äº‹æƒ…çš„çŠ¶å†µæˆ–æ ·å­', english: 'situation; condition' },
              { word: 'å°å¿ƒ', pinyin: 'xiÇo xÄ«n', chinese: 'æ³¨æ„ï¼Œè°¨æ…ï¼Œä¸ç²—å¿ƒ', english: 'careful; cautious' },
              { word: 'æ ‘æ', pinyin: 'shÃ¹ zhÄ«', chinese: 'æ ‘ä¸Šçš„ææ¡', english: 'tree branch' },
              { word: 'èªæ˜', pinyin: 'cÅng mÃ­ng', chinese: 'å¤´è„‘çµæ´»ï¼Œç†è§£åŠ›å¼º', english: 'clever; smart' },
              { word: 'æ', pinyin: 'tÃ­', chinese: 'ç”¨æ‰‹æ‹¿ç€ï¼ˆå‚ä¸‹çš„ä¸œè¥¿ï¼‰', english: 'to carry (by hand); to lift' }
            ],
            gameQuestions: [
              { 
                text: 'ä¸€ä¸ªä¸___ï¼Œçš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„æ ‘æ´é‡Œå»äº†ã€‚', 
                english: 'One of them was not ___, and the ball bounced into a tree hollow.',
                answer: 'å°å¿ƒ', 
                answerEnglish: 'careful',
                options: ['èªæ˜', 'å°å¿ƒ', 'ç€æ€¥', 'åŠæ³•'],
                optionsEnglish: ['clever', 'careful', 'anxious', 'method']
              },
              { 
                text: 'çš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„___é‡Œå»äº†ã€‚', 
                english: 'The ball bounced into a ___ of a big tree.',
                answer: 'æ ‘æ´', 
                answerEnglish: 'tree hollow',
                options: ['æ ‘æ', 'æƒ…å½¢', 'æ ‘æ´', 'è„‘ç­‹'],
                optionsEnglish: ['tree branch', 'situation', 'tree hollow', 'brain']
              },
              { 
                text: 'å¤§å®¶å¾ˆ___ï¼Œäº‰ç€æŠŠæ‰‹ä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒã€‚', 
                english: 'Everyone became ___ and tried to reach into the hole to get the ball.',
                answer: 'ç€æ€¥', 
                answerEnglish: 'anxious',
                options: ['å°å¿ƒ', 'èªæ˜', 'æµ®', 'ç€æ€¥'],
                optionsEnglish: ['careful', 'clever', 'float', 'anxious']
              },
              { 
                text: 'æœ‰äººæ‰¾æ¥ä¸€æ ¹___ï¼Œä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒã€‚', 
                english: 'Someone brought a ___ and tried to reach the ball.',
                answer: 'æ ‘æ', 
                answerEnglish: 'tree branch',
                options: ['æ ‘æ', 'æ ‘æ´', 'åŠæ³•', 'æ'],
                optionsEnglish: ['tree branch', 'tree hollow', 'method', 'carry']
              },
              { 
                text: 'ä¹Ÿæ²¡æœ‰___æŠŠå®ƒæ‹¿ä¸Šæ¥ã€‚', 
                english: 'They still had no ___ to get it out.',
                answer: 'åŠæ³•', 
                answerEnglish: 'solution',
                options: ['æƒ…å½¢', 'è„‘ç­‹', 'æµ®', 'åŠæ³•'],
                optionsEnglish: ['situation', 'brain', 'float', 'solution']
              }
            ],
            chineseSentences: [
              'å‡ ä¸ªå­©å­åœ¨ä¸€æ£µå¤§æ ‘ä¸‹æ‹çƒï¼Œä¸€ä¸ªä¸å°å¿ƒï¼Œçš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„æ ‘æ´é‡Œå»äº†ã€‚',
              'å¤§å®¶å¾ˆç€æ€¥ï¼Œäº‰ç€æŠŠæ‰‹ä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒã€‚',
              'å¯æ˜¯ï¼Œä»–ä»¬çš„æ‰‹å¤ªçŸ­äº†ï¼Œæ²¡æœ‰äººèƒ½æŠŠçš®çƒæ‹¿ä¸Šæ¥ã€‚',
              'æœ‰äººæ‰¾æ¥ä¸€æ ¹æ ‘æï¼Œä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒï¼Œå¯æ˜¯çƒå¤ªæ»‘äº†ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•æŠŠå®ƒæ‹¿ä¸Šæ¥ã€‚',
              'å¤§å®¶æ€¥å¾—å¿«å“­å‡ºæ¥äº†ã€‚',
              'åå›½æ˜¯ä¸ªèªæ˜çš„å­©å­ï¼Œå¹³æ—¶æœ€çˆ±åŠ¨è„‘ç­‹ã€‚',
              'ä»–çœ‹åˆ°è¿™ç§æƒ…å½¢ï¼Œåªè§ä»–çœ¼ç å­ä¸€è½¬ï¼Œå°±æƒ³åˆ°åŠæ³•äº†ã€‚',
              'ä»–è·‘å›å®¶å»ï¼Œä¸ä¹…ï¼Œææ¥äº†ä¸€æ¡¶æ°´ã€‚',
              'ä»–æŠŠæ°´å€’è¿›æ ‘æ´é‡Œï¼Œçš®çƒæµ®äº†ä¸Šæ¥ã€‚',
              'ä»–å°±è½»æ˜“åœ°æ‹¿åˆ°çƒäº†ã€‚'
            ],
            englishSentences: [
              'A few children were playing with a ball under a big tree. One of them was not careful, and the ball bounced into a tree hollow.',
              'Everyone became anxious and tried to reach into the hole to get the ball.',
              'But their arms were too shortâ€”no one could get the ball out.',
              'Someone brought a tree branch and tried to reach the ball, but it was too slippery, and they still had no solution.',
              'The children were about to cry.',
              'Hua Guo was a clever child who loved using his brain.',
              'When he saw the situation, his eyes turned and he came up with an idea.',
              'He ran home, and soon carried a bucket of water.',
              'He poured the water into the tree hollow, and the ball floated up.',
              'He easily picked it up.'
            ]
          };

          // ç¬¬äºŒç¯‡æ•°æ®
          const chapter2Data = {
            vocabulary: [
              { word: 'éª„å‚²', pinyin: 'jiÄo Ã o', chinese: 'çœ‹ä¸èµ·åˆ«äººï¼›ä¹Ÿå¯æŒ‡æ„Ÿåˆ°è‡ªè±ª', english: 'arrogant / proud' },
              { word: 'å­¦ä¹ ', pinyin: 'xuÃ© xÃ­', chinese: 'é€šè¿‡è¯»ä¹¦æˆ–ç»ƒä¹ æ¥è·å¾—çŸ¥è¯†æˆ–æŠ€èƒ½', english: 'to study / to learn' },
              { word: 'å›å®¶', pinyin: 'huÃ­ jiÄ', chinese: 'ä»å¤–é¢è¿”å›è‡ªå·±çš„å®¶é‡Œ', english: 'to go home' },
              { word: 'å‚åŠ ', pinyin: 'cÄn jiÄ', chinese: 'å‚ä¸æ´»åŠ¨æˆ–ç»„ç»‡', english: 'to participate / to join' },
              { word: 'ç¯®çƒ', pinyin: 'lÃ¡n qiÃº', chinese: 'ä¸€ç§ç”¨æ‰‹æ‹æ‰“çƒå¹¶æŠ•è¿›ç¯®ç­çš„è¿åŠ¨', english: 'basketball' },
              { word: 'å¸®åŠ©', pinyin: 'bÄng zhÃ¹', chinese: 'ååŠ©åˆ«äººè§£å†³å›°éš¾æˆ–å®Œæˆä»»åŠ¡', english: 'to help / to assist' },
              { word: 'æ¯”èµ›', pinyin: 'bÇ sÃ i', chinese: 'ä¸ºäº‰å–èƒœåˆ©è€Œè¿›è¡Œçš„ç«èµ›æ´»åŠ¨', english: 'competition / match' },
              { word: 'åŒç­', pinyin: 'tÃ³ng bÄn', chinese: 'åœ¨åŒä¸€ä¸ªç­çº§', english: 'same class' },
              { word: 'é«˜å…´', pinyin: 'gÄo xÃ¬ng', chinese: 'å¿ƒæƒ…æ„‰å¿«ï¼Œå¿«ä¹', english: 'happy / glad' },
              { word: 'è¦å¥½', pinyin: 'yÃ o hÇo', chinese: 'æ„Ÿæƒ…å¥½ï¼Œå…³ç³»äº²å¯†', english: 'close (in relationship) / good friends' }
            ],
            gameQuestions: [
              { 
                text: 'æˆ‘æœ‰å¾ˆå¤šæœ‹å‹,æ–‡é”¦å’Œæˆ‘æœ€___ã€‚', 
                english: 'I have many friends, and Wen Jin and I are the ___.',
                answer: 'è¦å¥½', 
                answerEnglish: 'closest',
                options: ['éª„å‚²', 'è¦å¥½', 'é«˜å…´', 'å¸®åŠ©'],
                optionsEnglish: ['arrogant', 'closest', 'happy', 'help']
              },
              { 
                text: 'æˆ‘ä»¬æ˜¯___åŒå­¦', 
                english: 'We are ___ classmates',
                answer: 'åŒç­', 
                answerEnglish: 'same class',
                options: ['æ¯”èµ›', 'ç¯®çƒ', 'åŒç­', 'å‚åŠ '],
                optionsEnglish: ['competition', 'basketball', 'same class', 'participate']
              },
              { 
                text: 'ç»å¸¸ä¸€èµ·ä¸Šå­¦,ä¸€èµ·___ã€‚', 
                english: 'We often go to school and ___ together.',
                answer: 'å›å®¶', 
                answerEnglish: 'go home',
                options: ['å­¦ä¹ ', 'éª„å‚²', 'å¸®åŠ©', 'å›å®¶'],
                optionsEnglish: ['study', 'arrogant', 'help', 'go home']
              },
              { 
                text: 'ä½†ä»–ä¸€ç‚¹ä¹Ÿä¸___', 
                english: 'But he is not ___ at all',
                answer: 'éª„å‚²', 
                answerEnglish: 'arrogant',
                options: ['é«˜å…´', 'éª„å‚²', 'è¦å¥½', 'åŒç­'],
                optionsEnglish: ['happy', 'arrogant', 'close', 'same class']
              },
              { 
                text: 'è¿˜å¸¸å¸¸___åŠŸè¯¾å·®çš„åŒå­¦ã€‚', 
                english: 'He often ___ classmates who are weak in their schoolwork.',
                answer: 'å¸®åŠ©', 
                answerEnglish: 'helps',
                options: ['æ¯”èµ›', 'å‚åŠ ', 'å­¦ä¹ ', 'å¸®åŠ©'],
                optionsEnglish: ['competition', 'participate', 'study', 'helps']
              }
            ],
            chineseSentences: [
              'æˆ‘æœ‰å¾ˆå¤šæœ‹å‹ï¼Œæ–‡é”¦å’Œæˆ‘æœ€è¦å¥½ã€‚',
              'æˆ‘ä»¬æ˜¯åŒç­åŒå­¦ï¼Œç»å¸¸ä¸€èµ·ä¸Šå­¦ï¼Œä¸€èµ·å›å®¶ã€‚',
              'æ–‡é”¦çš„åŠŸè¯¾å¾ˆå¥½ï¼Œä½†ä»–ä¸€ç‚¹ä¹Ÿä¸éª„å‚²ï¼Œè¿˜å¸¸å¸¸å¸®åŠ©åŠŸè¯¾å·®çš„åŒå­¦ã€‚',
              'æ­¤å¤–ï¼Œä»–ä¹Ÿæ—¶å¸¸å‚åŠ è¯¾å¤–æ´»åŠ¨ã€‚',
              'ä»–çš„ç¯®çƒæ‰“å¾—å¾ˆå¥½ï¼Œæ—¶å¸¸å‚åŠ æ¯”èµ›ã€‚',
              'æˆ‘å¾ˆé«˜å…´æœ‰æ–‡é”¦è¿™ä¹ˆä¸€ä¸ªå¥½æœ‹å‹ï¼Œæˆ‘ä¹Ÿè¦å‘ä»–å¤šå­¦ä¹ ã€‚'
            ],
            englishSentences: [
              'I have many friends, and Wen Jin and I are the closest.',
              'We are in the same class, and we often go to school and go home together.',
              'Wen Jin does well in his studies, but he is not proud at all. He often helps classmates who are weak in their schoolwork.',
              'In addition, he often takes part in extracurricular activities.',
              'He plays basketball very well and often joins competitions.',
              'I feel very happy to have such a good friend like Wen Jin, and I want to learn from him more.'
            ]
          };

          const encouragementWords = [
            'å¾ˆå‰å®³ï¼', 'ä½ æ£’æ£’çš„ï¼', 'åŠ æ²¹ä¸‹ä¸€é¢˜ï¼', 'å¤ªæ£’äº†ï¼', 
            'ç»§ç»­åŠ æ²¹ï¼', 'ä½ çœŸèªæ˜ï¼', 'åšå¾—å¾ˆå¥½ï¼', 'çœŸå‰å®³ï¼',
            'è¶…çº§æ£’ï¼', 'ä½ å¤ªå‰å®³äº†ï¼'
          ];

          // æ£€æµ‹Appleè®¾å¤‡
          const isAppleDevice = /iPad|iPhone|iPod|Mac/.test(navigator.userAgent);

          // æ–‡å­—è½¬è¯­éŸ³åŠŸèƒ½
          const speakText = (text, language = 'zh-CN') => {
            if ('speechSynthesis' in window) {
              window.speechSynthesis.cancel();
              
              let cleanText = text;
              
              if (language === 'zh-CN') {
                cleanText = cleanText.replace(/\s*[\/\|]\s*[a-zA-Z].*/g, '');
              } else {
                cleanText = cleanText.replace(/[\/\|]/g, ' ');
              }
              
              cleanText = cleanText.replace(/_/g, ' ')
                                  .replace(/underscore/gi, '')
                                  .replace(/\bslash\b/gi, '')
                                  .replace(/\s+/g, ' ')
                                  .trim();
              
              const utterance = new SpeechSynthesisUtterance(cleanText);
              utterance.lang = language;
              utterance.rate = 0.8;
              utterance.pitch = 1.2;
              utterance.volume = 1.0;
              
              if (isAppleDevice) {
                utterance.volume = 1.0;
                utterance.rate = 0.7;
              }
              
              window.speechSynthesis.speak(utterance);
              return utterance;
            } else {
              if (isAppleDevice) {
                alert('Appleè®¾å¤‡è¯­éŸ³åŠŸèƒ½å—é™ï¼Œè¯·ï¼š\n1. æ£€æŸ¥é™éŸ³å¼€å…³\n2. è°ƒé«˜éŸ³é‡\n3. å°è¯•å¤šæ¬¡ç‚¹å‡»\n4. å»ºè®®ä½¿ç”¨Chromeæµè§ˆå™¨');
              } else {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åŠŸèƒ½');
              }
              return null;
            }
          };

          const getCurrentData = () => {
            if (currentChapter === 'chapter1') return chapter1Data;
            if (currentChapter === 'chapter2') return chapter2Data;
            return chapter1Data; // é»˜è®¤è¿”å›ç¬¬ä¸€ç« 
          };

          const resetChapterData = () => {
            setCurrentPhase('learning');
            setCurrentWordIndex(0);
            setViewedChinese(false);
            setViewedEnglish(false);
            setGameAnswers({});
            setWrongCount(0);
            setCurrentQuestion(0);
            setGameCompleted(false);
            setReadingLanguage('');
            setCurrentSentence(-1);
            setIsReading(false);
          };

          const handleChapterSelect = (chapter) => {
            setCurrentChapter(chapter);
            resetChapterData();
          };

          const backToMenu = () => {
            if ('speechSynthesis' in window) {
              window.speechSynthesis.cancel();
            }
            setCurrentChapter('menu');
            resetChapterData();
          };

          const chapterTitle = currentChapter === 'chapter1' ? 'ç¬¬ä¸€ç¯‡ï¼šåå›½çš„åŠæ³•' : 
                              currentChapter === 'chapter2' ? 'ç¬¬äºŒç¯‡ï¼šå¥½æœ‹å‹' : 'ç¬¬ä¸€ç¯‡ï¼šåå›½çš„åŠæ³•';

          const handleViewChinese = () => {
            setViewedChinese(true);
            speakText(getCurrentData().vocabulary[currentWordIndex].chinese);
          };

          const handleViewEnglish = () => {
            setViewedEnglish(true);
            speakText(getCurrentData().vocabulary[currentWordIndex].english, 'en-US');
          };

          const handlePreviousWord = () => {
            if (currentWordIndex > 0) {
              setCurrentWordIndex(currentWordIndex - 1);
              setViewedChinese(false);
              setViewedEnglish(false);
            }
          };

          const handleNextWord = () => {
            if (currentWordIndex < getCurrentData().vocabulary.length - 1) {
              setCurrentWordIndex(currentWordIndex + 1);
              setViewedChinese(false);
              setViewedEnglish(false);
            } else {
              setCurrentPhase('game');
            }
          };

          const handleGameAnswer = (selectedAnswer) => {
            const currentQ = getCurrentData().gameQuestions[currentQuestion];
            const isCorrect = selectedAnswer === currentQ.answer;
            
            if (isCorrect) {
              const randomEncouragement = encouragementWords[Math.floor(Math.random() * encouragementWords.length)];
              alert(randomEncouragement);
              speakText(randomEncouragement);
              
              setGameAnswers({...gameAnswers, [currentQuestion]: selectedAnswer});
              setWrongCount(0);
              
              if (currentQuestion < getCurrentData().gameQuestions.length - 1) {
                setCurrentQuestion(currentQuestion + 1);
              } else {
                setGameCompleted(true);
                setCurrentPhase('reading');
              }
            } else {
              const newWrongCount = wrongCount + 1;
              setWrongCount(newWrongCount);
              
              if (newWrongCount >= 3) {
                alert('éœ€è¦é‡æ–°å¼€å§‹ç»ƒä¹ ï¼');
                speakText('éœ€è¦é‡æ–°å¼€å§‹ç»ƒä¹ ï¼');
                setCurrentQuestion(0);
                setGameAnswers({});
                setWrongCount(0);
              } else {
                alert('ç­”é”™äº†ï¼Œå†è¯•è¯•ï¼');
                speakText('ç­”é”™äº†ï¼Œå†è¯•è¯•ï¼');
              }
            }
          };

          const handleReading = (language) => {
            setReadingLanguage(language);
            setCurrentSentence(0);
            setIsReading(true);
            
            setTimeout(() => {
              const sentences = language === 'chinese' ? getCurrentData().chineseSentences : getCurrentData().englishSentences;
              speakText(sentences[0], language === 'chinese' ? 'zh-CN' : 'en-US');
            }, 500);
          };

          const handleNextSentence = () => {
            const sentences = readingLanguage === 'chinese' ? getCurrentData().chineseSentences : getCurrentData().englishSentences;
            if (currentSentence < sentences.length - 1) {
              const nextIndex = currentSentence + 1;
              setCurrentSentence(nextIndex);
              
              setTimeout(() => {
                speakText(sentences[nextIndex], readingLanguage === 'chinese' ? 'zh-CN' : 'en-US');
              }, 300);
            } else {
              setIsReading(false);
              alert('æœ—è¯»å®Œæˆï¼ä½ å­¦å¾—å¾ˆæ£’ï¼');
            }
          };

          // Main render function
          if (currentChapter === 'menu') {
            return (
              <div className="container">
                <div className="header">
                  <h1 className="title">ğŸ“ ä¸­æ–‡å­¦ä¹ å¤©åœ°</h1>
                  <p className="subtitle">Chinese Learning Paradise - Complete Edition</p>
                </div>
                
                <div className="card">
                  <div className="grid">
                    <div className="chapter-card" onClick={() => handleChapterSelect('chapter1')}>
                      <div className="chapter-icon">âš½</div>
                      <h3 className="chapter-title">ç¬¬ä¸€ç¯‡ï¼šåå›½çš„åŠæ³•</h3>
                      <h4 className="chapter-subtitle">Chapter 1: Hua Guo's Solution</h4>
                      <p className="chapter-desc">
                        å­¦ä¹ å…³äºè§£å†³é—®é¢˜çš„10ä¸ªè¯æ±‡<br/>
                        Learn 10 problem-solving words
                      </p>
                      <button className="btn">å¼€å§‹å­¦ä¹  Start Learning</button>
                    </div>
                    
                    <div className="chapter-card" onClick={() => handleChapterSelect('chapter2')}>
                      <div className="chapter-icon">ğŸ‘«</div>
                      <h3 className="chapter-title">ç¬¬äºŒç¯‡ï¼šå¥½æœ‹å‹</h3>
                      <h4 className="chapter-subtitle">Chapter 2: Good Friends</h4>
                      <p className="chapter-desc">
                        å­¦ä¹ å…³äºå‹è°Šçš„10ä¸ªè¯æ±‡<br/>
                        Learn 10 friendship words
                      </p>
                      <button className="btn">å¼€å§‹å­¦ä¹  Start Learning</button>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // Learning phase
          if (currentPhase === 'learning') {
            const currentWord = getCurrentData().vocabulary[currentWordIndex];
            return (
              <div className="container">
                <button className="back-btn" onClick={backToMenu}>ğŸ  è¿”å›ä¸»é¡µ</button>
                
                <div className="header">
                  <h1 className="title">ğŸ“š è¯æ±‡å­¦ä¹ </h1>
                  <p className="subtitle">{chapterTitle}</p>
                </div>
                
                <div className="card learning-card">
                  <div className="progress">
                    ç¬¬ {currentWordIndex + 1} ä¸ªè¯æ±‡ / {getCurrentData().vocabulary.length} ä¸ª
                  </div>
                  
                  <div className="word-display">{currentWord.word}</div>
                  <div className="pinyin">{currentWord.pinyin}</div>
                  
                  <button className="btn" onClick={() => speakText(currentWord.word)}>
                    ğŸ”Š æœ—è¯»è¯è¯­
                  </button>
                  
                  <div style={{margin: '2rem 0'}}>
                    {viewedChinese ? (
                      <div className="explanation">
                        <strong>ä¸­æ–‡è§£é‡Šï¼š</strong>{currentWord.chinese}
                      </div>
                    ) : (
                      <button className="btn" onClick={handleViewChinese}>
                        æŸ¥çœ‹åè¯­è§£é‡Š
                      </button>
                    )}
                    
                    {viewedEnglish ? (
                      <div className="explanation">
                        <strong>English:</strong> {currentWord.english}
                      </div>
                    ) : (
                      <button className="btn" onClick={handleViewEnglish}>
                        æŸ¥çœ‹è‹±æ–‡è§£é‡Š
                      </button>
                    )}
                  </div>
                  
                  {viewedChinese && viewedEnglish ? (
                    <div className="controls">
                      {currentWordIndex > 0 && (
                        <button className="btn btn-secondary" onClick={handlePreviousWord}>
                          â† ä¸Šä¸€ä¸ªè¯æ±‡
                        </button>
                      )}
                      <button className="btn" onClick={handleNextWord}>
                        {currentWordIndex < getCurrentData().vocabulary.length - 1 ? 'ä¸‹ä¸€ä¸ªè¯æ±‡ â†’' : 'å¼€å§‹ç»ƒä¹  ğŸ®'}
                      </button>
                    </div>
                  ) : (
                    <p style={{textAlign: 'center', color: '#666'}}>
                      è¯·å…ˆæŸ¥çœ‹åè¯­å’Œè‹±æ–‡è§£é‡Š
                    </p>
                  )}
                </div>
              </div>
            );
          }

          // Game phase
          if (currentPhase === 'game') {
            const currentQ = getCurrentData().gameQuestions[currentQuestion];
            return (
              <div className="container">
                <button className="back-btn" onClick={backToMenu}>ğŸ  è¿”å›ä¸»é¡µ</button>
                
                <div className="header">
                  <h1 className="title">ğŸ® å¡«ç©ºç»ƒä¹ </h1>
                  <p className="subtitle">{chapterTitle}</p>
                </div>
                
                <div className="card game-card">
                  <div className="progress">
                    ç¬¬ {currentQuestion + 1} é¢˜ / {getCurrentData().gameQuestions.length} é¢˜
                  </div>
                  
                  <div className="question">
                    <div className="question-text">{currentQ.text}</div>
                    <div className="question-english">{currentQ.english}</div>
                    <button className="btn" onClick={() => speakText(currentQ.text)}>
                      ğŸ”Š æœ—è¯»é¢˜ç›®
                    </button>
                  </div>
                  
                  <div className="options">
                    {currentQ.options.map((option, index) => (
                      <button 
                        key={index}
                        className="option-btn"
                        onClick={() => handleGameAnswer(option)}
                      >
                        {option}<br/>
                        <small>({currentQ.optionsEnglish[index]})</small>
                      </button>
                    ))}
                  </div>
                  
                  {wrongCount > 0 && (
                    <div style={{textAlign: 'center', color: 'red', fontWeight: 'bold'}}>
                      é”™è¯¯æ¬¡æ•°: {wrongCount}/3
                    </div>
                  )}
                  
                  <div className="controls">
                    <button className="btn btn-secondary" onClick={() => setCurrentPhase('learning')}>
                      ğŸ“š è¿”å›è¯æ±‡å­¦ä¹ 
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          // Reading phase
          if (currentPhase === 'reading') {
            if (!isReading) {
              return (
                <div className="container">
                  <button className="back-btn" onClick={backToMenu}>ğŸ  è¿”å›ä¸»é¡µ</button>
                  
                  <div className="header">
                    <h1 className="title">ğŸ“– ä½œæ–‡æœ—è¯»</h1>
                    <p className="subtitle">{chapterTitle}</p>
                  </div>
                  
                  <div className="card reading-card">
                    <h2 style={{textAlign: 'center', marginBottom: '2rem'}}>
                      ğŸ‰ æ­å–œå®Œæˆæ‰€æœ‰ç»ƒä¹ ï¼
                    </h2>
                    <p style={{textAlign: 'center', fontSize: '1.2rem', marginBottom: '2rem'}}>
                      é€‰æ‹©è¯­è¨€å¼€å§‹æœ—è¯»æ•…äº‹ï¼š<br/>
                      Choose a language to read the story:
                    </p>
                    
                    <div className="controls">
                      <button className="btn" onClick={() => handleReading('chinese')}>
                        ğŸ‡¨ğŸ‡³ ä¸­æ–‡æœ—è¯»
                      </button>
                      <button className="btn" onClick={() => handleReading('english')}>
                        ğŸ‡ºğŸ‡¸ è‹±æ–‡æœ—è¯»
                      </button>
                    </div>
                    
                    <div className="controls">
                      <button className="btn btn-secondary" onClick={() => resetChapterData()}>
                        ğŸ”„ é‡æ–°å¼€å§‹æœ¬ç« 
                      </button>
                    </div>
                  </div>
                </div>
              );
            } else {
              const sentences = readingLanguage === 'chinese' ? getCurrentData().chineseSentences : getCurrentData().englishSentences;
              
              return (
                <div className="container">
                  <button className="back-btn" onClick={backToMenu}>ğŸ  è¿”å›ä¸»é¡µ</button>
                  
                  <div className="header">
                    <h1 className="title">ğŸ“– {readingLanguage === 'chinese' ? 'ä¸­æ–‡æœ—è¯»' : 'English Reading'}</h1>
                    <p className="subtitle">{chapterTitle}</p>
                  </div>
                  
                  <div className="card reading-card">
                    <div className="progress">
                      ç¬¬ {currentSentence + 1} å¥ / {sentences.length} å¥
                    </div>
                    
                    <div className="story-container">
                      {sentences.map((sentence, index) => (
                        <div 
                          key={index}
                          className={`sentence ${index === currentSentence ? 'current-sentence' : ''}`}
                        >
                          {sentence}
                        </div>
                      ))}
                    </div>
                    
                    <div className="controls">
                      <button className="btn" onClick={() => speakText(sentences[currentSentence], readingLanguage === 'chinese' ? 'zh-CN' : 'en-US')}>
                        ğŸ”Š é‡æ–°æœ—è¯»è¿™å¥
                      </button>
                      <button className="btn" onClick={handleNextSentence}>
                        {currentSentence < sentences.length - 1 ? 'ä¸‹ä¸€å¥ â†’' : 'å®Œæˆæœ—è¯» âœ…'}
                      </button>
                    </div>
                    
                    <div className="controls">
                      <button className="btn btn-secondary" onClick={() => {setIsReading(false); setReadingLanguage('');}}>
                        â† è¿”å›é€‰æ‹©è¯­è¨€
                      </button>
                    </div>
                  </div>
                </div>
              );
            }
          }

          return null;
        };

        // Render the app
        ReactDOM.render(<ChineseLearningCompleteApp />, document.getElementById('root'));
    </script>
</body>
</html>