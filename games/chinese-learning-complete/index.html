<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Learning Complete - AEC Games</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
        }
        #root {
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 2rem;
            margin: 1rem 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 2rem;
        }
        .title {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .subtitle {
            font-size: 1.5rem;
            opacity: 0.9;
            margin-bottom: 2rem;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }
        .chapter-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #333;
        }
        .chapter-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
        }
        .chapter-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .chapter-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .chapter-subtitle {
            font-size: 1rem;
            margin-bottom: 1rem;
            opacity: 0.8;
        }
        .chapter-desc {
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            line-height: 1.4;
        }
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        .btn:hover {
            background: linear-gradient(45deg, #764ba2, #667eea);
            transform: scale(1.05);
        }
        .btn-secondary {
            background: #666;
        }
        .btn-secondary:hover {
            background: #555;
        }
        .learning-card {
            text-align: center;
            padding: 2rem;
        }
        .word-display {
            font-size: 4rem;
            font-weight: bold;
            color: #667eea;
            margin: 1rem 0;
        }
        .pinyin {
            font-size: 1.5rem;
            color: #666;
            margin-bottom: 2rem;
        }
        .explanation {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid #667eea;
        }
        .game-card {
            padding: 2rem;
        }
        .question {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: #333;
        }
        .question-english {
            font-size: 1rem;
            color: #666;
        }
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        .option-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .option-btn:hover {
            background: #764ba2;
            transform: scale(1.02);
        }
        .reading-card {
            padding: 2rem;
        }
        .story-container {
            background: #fffbf0;
            padding: 2rem;
            border-radius: 15px;
            border-left: 4px solid #ffd700;
            margin: 2rem 0;
        }
        .sentence {
            font-size: 1.1rem;
            line-height: 1.8;
            margin: 1rem 0;
            padding: 0.5rem;
            border-radius: 5px;
        }
        .current-sentence {
            background: #fff3cd;
            border: 2px solid #ffc107;
            font-weight: bold;
            color: #856404;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }
        .back-btn {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: #666;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
        }
        .progress {
            text-align: center;
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 2rem;
        }
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .title { font-size: 2rem; }
            .word-display { font-size: 3rem; }
            .grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { BookOpen, Play, Volume2, RotateCcw, Gamepad2, Speaker, Home, ArrowLeft } = lucide;

        const ChineseLearningCompleteApp = () => {
          const [currentChapter, setCurrentChapter] = useState('menu');
          const [currentPhase, setCurrentPhase] = useState('learning');
          const [currentWordIndex, setCurrentWordIndex] = useState(0);
          const [viewedChinese, setViewedChinese] = useState(false);
          const [viewedEnglish, setViewedEnglish] = useState(false);
          const [gameAnswers, setGameAnswers] = useState({});
          const [wrongCount, setWrongCount] = useState(0);
          const [currentQuestion, setCurrentQuestion] = useState(0);
          const [gameCompleted, setGameCompleted] = useState(false);
          const [readingLanguage, setReadingLanguage] = useState('');
          const [currentSentence, setCurrentSentence] = useState(-1);
          const [isReading, setIsReading] = useState(false);

          // 第一篇数据
          const chapter1Data = {
            vocabulary: [
              { word: '办法', pinyin: 'bàn fǎ', chinese: '处理事情或解决问题的方法', english: 'way; method; solution' },
              { word: '脑筋', pinyin: 'nǎo jīn', chinese: '思维和理解能力；想法', english: 'brain; mind; ideas' },
              { word: '浮', pinyin: 'fú', chinese: '漂在水面上，不下沉', english: 'to float' },
              { word: '树洞', pinyin: 'shù dòng', chinese: '树干上的空洞', english: 'tree hollow' },
              { word: '着急', pinyin: 'zháo jí', chinese: '心里紧张，不安', english: 'anxious; worried' },
              { word: '情形', pinyin: 'qíng xíng', chinese: '事情的状况或样子', english: 'situation; condition' },
              { word: '小心', pinyin: 'xiǎo xīn', chinese: '注意，谨慎，不粗心', english: 'careful; cautious' },
              { word: '树枝', pinyin: 'shù zhī', chinese: '树上的枝条', english: 'tree branch' },
              { word: '聪明', pinyin: 'cōng míng', chinese: '头脑灵活，理解力强', english: 'clever; smart' },
              { word: '提', pinyin: 'tí', chinese: '用手拿着（垂下的东西）', english: 'to carry (by hand); to lift' }
            ],
            gameQuestions: [
              { 
                text: '一个不___，皮球跳进一棵大树的树洞里去了。', 
                english: 'One of them was not ___, and the ball bounced into a tree hollow.',
                answer: '小心', 
                answerEnglish: 'careful',
                options: ['聪明', '小心', '着急', '办法'],
                optionsEnglish: ['clever', 'careful', 'anxious', 'method']
              },
              { 
                text: '皮球跳进一棵大树的___里去了。', 
                english: 'The ball bounced into a ___ of a big tree.',
                answer: '树洞', 
                answerEnglish: 'tree hollow',
                options: ['树枝', '情形', '树洞', '脑筋'],
                optionsEnglish: ['tree branch', 'situation', 'tree hollow', 'brain']
              },
              { 
                text: '大家很___，争着把手伸进树洞里去拿球。', 
                english: 'Everyone became ___ and tried to reach into the hole to get the ball.',
                answer: '着急', 
                answerEnglish: 'anxious',
                options: ['小心', '聪明', '浮', '着急'],
                optionsEnglish: ['careful', 'clever', 'float', 'anxious']
              },
              { 
                text: '有人找来一根___，伸进树洞里去拿球。', 
                english: 'Someone brought a ___ and tried to reach the ball.',
                answer: '树枝', 
                answerEnglish: 'tree branch',
                options: ['树枝', '树洞', '办法', '提'],
                optionsEnglish: ['tree branch', 'tree hollow', 'method', 'carry']
              },
              { 
                text: '也没有___把它拿上来。', 
                english: 'They still had no ___ to get it out.',
                answer: '办法', 
                answerEnglish: 'solution',
                options: ['情形', '脑筋', '浮', '办法'],
                optionsEnglish: ['situation', 'brain', 'float', 'solution']
              }
            ],
            chineseSentences: [
              '几个孩子在一棵大树下拍球，一个不小心，皮球跳进一棵大树的树洞里去了。',
              '大家很着急，争着把手伸进树洞里去拿球。',
              '可是，他们的手太短了，没有人能把皮球拿上来。',
              '有人找来一根树枝，伸进树洞里去拿球，可是球太滑了，也没有办法把它拿上来。',
              '大家急得快哭出来了。',
              '华国是个聪明的孩子，平时最爱动脑筋。',
              '他看到这种情形，只见他眼珠子一转，就想到办法了。',
              '他跑回家去，不久，提来了一桶水。',
              '他把水倒进树洞里，皮球浮了上来。',
              '他就轻易地拿到球了。'
            ],
            englishSentences: [
              'A few children were playing with a ball under a big tree. One of them was not careful, and the ball bounced into a tree hollow.',
              'Everyone became anxious and tried to reach into the hole to get the ball.',
              'But their arms were too short—no one could get the ball out.',
              'Someone brought a tree branch and tried to reach the ball, but it was too slippery, and they still had no solution.',
              'The children were about to cry.',
              'Hua Guo was a clever child who loved using his brain.',
              'When he saw the situation, his eyes turned and he came up with an idea.',
              'He ran home, and soon carried a bucket of water.',
              'He poured the water into the tree hollow, and the ball floated up.',
              'He easily picked it up.'
            ]
          };

          // 第二篇数据
          const chapter2Data = {
            vocabulary: [
              { word: '骄傲', pinyin: 'jiāo ào', chinese: '看不起别人；也可指感到自豪', english: 'arrogant / proud' },
              { word: '学习', pinyin: 'xué xí', chinese: '通过读书或练习来获得知识或技能', english: 'to study / to learn' },
              { word: '回家', pinyin: 'huí jiā', chinese: '从外面返回自己的家里', english: 'to go home' },
              { word: '参加', pinyin: 'cān jiā', chinese: '参与活动或组织', english: 'to participate / to join' },
              { word: '篮球', pinyin: 'lán qiú', chinese: '一种用手拍打球并投进篮筐的运动', english: 'basketball' },
              { word: '帮助', pinyin: 'bāng zhù', chinese: '协助别人解决困难或完成任务', english: 'to help / to assist' },
              { word: '比赛', pinyin: 'bǐ sài', chinese: '为争取胜利而进行的竞赛活动', english: 'competition / match' },
              { word: '同班', pinyin: 'tóng bān', chinese: '在同一个班级', english: 'same class' },
              { word: '高兴', pinyin: 'gāo xìng', chinese: '心情愉快，快乐', english: 'happy / glad' },
              { word: '要好', pinyin: 'yào hǎo', chinese: '感情好，关系亲密', english: 'close (in relationship) / good friends' }
            ],
            gameQuestions: [
              { 
                text: '我有很多朋友,文锦和我最___。', 
                english: 'I have many friends, and Wen Jin and I are the ___.',
                answer: '要好', 
                answerEnglish: 'closest',
                options: ['骄傲', '要好', '高兴', '帮助'],
                optionsEnglish: ['arrogant', 'closest', 'happy', 'help']
              },
              { 
                text: '我们是___同学', 
                english: 'We are ___ classmates',
                answer: '同班', 
                answerEnglish: 'same class',
                options: ['比赛', '篮球', '同班', '参加'],
                optionsEnglish: ['competition', 'basketball', 'same class', 'participate']
              },
              { 
                text: '经常一起上学,一起___。', 
                english: 'We often go to school and ___ together.',
                answer: '回家', 
                answerEnglish: 'go home',
                options: ['学习', '骄傲', '帮助', '回家'],
                optionsEnglish: ['study', 'arrogant', 'help', 'go home']
              },
              { 
                text: '但他一点也不___', 
                english: 'But he is not ___ at all',
                answer: '骄傲', 
                answerEnglish: 'arrogant',
                options: ['高兴', '骄傲', '要好', '同班'],
                optionsEnglish: ['happy', 'arrogant', 'close', 'same class']
              },
              { 
                text: '还常常___功课差的同学。', 
                english: 'He often ___ classmates who are weak in their schoolwork.',
                answer: '帮助', 
                answerEnglish: 'helps',
                options: ['比赛', '参加', '学习', '帮助'],
                optionsEnglish: ['competition', 'participate', 'study', 'helps']
              }
            ],
            chineseSentences: [
              '我有很多朋友，文锦和我最要好。',
              '我们是同班同学，经常一起上学，一起回家。',
              '文锦的功课很好，但他一点也不骄傲，还常常帮助功课差的同学。',
              '此外，他也时常参加课外活动。',
              '他的篮球打得很好，时常参加比赛。',
              '我很高兴有文锦这么一个好朋友，我也要向他多学习。'
            ],
            englishSentences: [
              'I have many friends, and Wen Jin and I are the closest.',
              'We are in the same class, and we often go to school and go home together.',
              'Wen Jin does well in his studies, but he is not proud at all. He often helps classmates who are weak in their schoolwork.',
              'In addition, he often takes part in extracurricular activities.',
              'He plays basketball very well and often joins competitions.',
              'I feel very happy to have such a good friend like Wen Jin, and I want to learn from him more.'
            ]
          };

          const encouragementWords = [
            '很厉害！', '你棒棒的！', '加油下一题！', '太棒了！', 
            '继续加油！', '你真聪明！', '做得很好！', '真厉害！',
            '超级棒！', '你太厉害了！'
          ];

          // 检测Apple设备
          const isAppleDevice = /iPad|iPhone|iPod|Mac/.test(navigator.userAgent);

          // 文字转语音功能
          const speakText = (text, language = 'zh-CN') => {
            if ('speechSynthesis' in window) {
              window.speechSynthesis.cancel();
              
              let cleanText = text;
              
              if (language === 'zh-CN') {
                cleanText = cleanText.replace(/\s*[\/\|]\s*[a-zA-Z].*/g, '');
              } else {
                cleanText = cleanText.replace(/[\/\|]/g, ' ');
              }
              
              cleanText = cleanText.replace(/_/g, ' ')
                                  .replace(/underscore/gi, '')
                                  .replace(/\bslash\b/gi, '')
                                  .replace(/\s+/g, ' ')
                                  .trim();
              
              const utterance = new SpeechSynthesisUtterance(cleanText);
              utterance.lang = language;
              utterance.rate = 0.8;
              utterance.pitch = 1.2;
              utterance.volume = 1.0;
              
              if (isAppleDevice) {
                utterance.volume = 1.0;
                utterance.rate = 0.7;
              }
              
              window.speechSynthesis.speak(utterance);
              return utterance;
            } else {
              if (isAppleDevice) {
                alert('Apple设备语音功能受限，请：\n1. 检查静音开关\n2. 调高音量\n3. 尝试多次点击\n4. 建议使用Chrome浏览器');
              } else {
                alert('您的浏览器不支持语音功能');
              }
              return null;
            }
          };

          const getCurrentData = () => {
            if (currentChapter === 'chapter1') return chapter1Data;
            if (currentChapter === 'chapter2') return chapter2Data;
            return chapter1Data; // 默认返回第一章
          };

          const resetChapterData = () => {
            setCurrentPhase('learning');
            setCurrentWordIndex(0);
            setViewedChinese(false);
            setViewedEnglish(false);
            setGameAnswers({});
            setWrongCount(0);
            setCurrentQuestion(0);
            setGameCompleted(false);
            setReadingLanguage('');
            setCurrentSentence(-1);
            setIsReading(false);
          };

          const handleChapterSelect = (chapter) => {
            setCurrentChapter(chapter);
            resetChapterData();
          };

          const backToMenu = () => {
            if ('speechSynthesis' in window) {
              window.speechSynthesis.cancel();
            }
            setCurrentChapter('menu');
            resetChapterData();
          };

          const chapterTitle = currentChapter === 'chapter1' ? '第一篇：华国的办法' : 
                              currentChapter === 'chapter2' ? '第二篇：好朋友' : '第一篇：华国的办法';

          const handleViewChinese = () => {
            setViewedChinese(true);
            speakText(getCurrentData().vocabulary[currentWordIndex].chinese);
          };

          const handleViewEnglish = () => {
            setViewedEnglish(true);
            speakText(getCurrentData().vocabulary[currentWordIndex].english, 'en-US');
          };

          const handlePreviousWord = () => {
            if (currentWordIndex > 0) {
              setCurrentWordIndex(currentWordIndex - 1);
              setViewedChinese(false);
              setViewedEnglish(false);
            }
          };

          const handleNextWord = () => {
            if (currentWordIndex < getCurrentData().vocabulary.length - 1) {
              setCurrentWordIndex(currentWordIndex + 1);
              setViewedChinese(false);
              setViewedEnglish(false);
            } else {
              setCurrentPhase('game');
            }
          };

          const handleGameAnswer = (selectedAnswer) => {
            const currentQ = getCurrentData().gameQuestions[currentQuestion];
            const isCorrect = selectedAnswer === currentQ.answer;
            
            if (isCorrect) {
              const randomEncouragement = encouragementWords[Math.floor(Math.random() * encouragementWords.length)];
              alert(randomEncouragement);
              speakText(randomEncouragement);
              
              setGameAnswers({...gameAnswers, [currentQuestion]: selectedAnswer});
              setWrongCount(0);
              
              if (currentQuestion < getCurrentData().gameQuestions.length - 1) {
                setCurrentQuestion(currentQuestion + 1);
              } else {
                setGameCompleted(true);
                setCurrentPhase('reading');
              }
            } else {
              const newWrongCount = wrongCount + 1;
              setWrongCount(newWrongCount);
              
              if (newWrongCount >= 3) {
                alert('需要重新开始练习！');
                speakText('需要重新开始练习！');
                setCurrentQuestion(0);
                setGameAnswers({});
                setWrongCount(0);
              } else {
                alert('答错了，再试试！');
                speakText('答错了，再试试！');
              }
            }
          };

          const handleReading = (language) => {
            setReadingLanguage(language);
            setCurrentSentence(0);
            setIsReading(true);
            
            setTimeout(() => {
              const sentences = language === 'chinese' ? getCurrentData().chineseSentences : getCurrentData().englishSentences;
              speakText(sentences[0], language === 'chinese' ? 'zh-CN' : 'en-US');
            }, 500);
          };

          const handleNextSentence = () => {
            const sentences = readingLanguage === 'chinese' ? getCurrentData().chineseSentences : getCurrentData().englishSentences;
            if (currentSentence < sentences.length - 1) {
              const nextIndex = currentSentence + 1;
              setCurrentSentence(nextIndex);
              
              setTimeout(() => {
                speakText(sentences[nextIndex], readingLanguage === 'chinese' ? 'zh-CN' : 'en-US');
              }, 300);
            } else {
              setIsReading(false);
              alert('朗读完成！你学得很棒！');
            }
          };

          // Main render function
          if (currentChapter === 'menu') {
            return (
              <div className="container">
                <div className="header">
                  <h1 className="title">🎓 中文学习天地</h1>
                  <p className="subtitle">Chinese Learning Paradise - Complete Edition</p>
                </div>
                
                <div className="card">
                  <div className="grid">
                    <div className="chapter-card" onClick={() => handleChapterSelect('chapter1')}>
                      <div className="chapter-icon">⚽</div>
                      <h3 className="chapter-title">第一篇：华国的办法</h3>
                      <h4 className="chapter-subtitle">Chapter 1: Hua Guo's Solution</h4>
                      <p className="chapter-desc">
                        学习关于解决问题的10个词汇<br/>
                        Learn 10 problem-solving words
                      </p>
                      <button className="btn">开始学习 Start Learning</button>
                    </div>
                    
                    <div className="chapter-card" onClick={() => handleChapterSelect('chapter2')}>
                      <div className="chapter-icon">👫</div>
                      <h3 className="chapter-title">第二篇：好朋友</h3>
                      <h4 className="chapter-subtitle">Chapter 2: Good Friends</h4>
                      <p className="chapter-desc">
                        学习关于友谊的10个词汇<br/>
                        Learn 10 friendship words
                      </p>
                      <button className="btn">开始学习 Start Learning</button>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // Learning phase
          if (currentPhase === 'learning') {
            const currentWord = getCurrentData().vocabulary[currentWordIndex];
            return (
              <div className="container">
                <button className="back-btn" onClick={backToMenu}>🏠 返回主页</button>
                
                <div className="header">
                  <h1 className="title">📚 词汇学习</h1>
                  <p className="subtitle">{chapterTitle}</p>
                </div>
                
                <div className="card learning-card">
                  <div className="progress">
                    第 {currentWordIndex + 1} 个词汇 / {getCurrentData().vocabulary.length} 个
                  </div>
                  
                  <div className="word-display">{currentWord.word}</div>
                  <div className="pinyin">{currentWord.pinyin}</div>
                  
                  <button className="btn" onClick={() => speakText(currentWord.word)}>
                    🔊 朗读词语
                  </button>
                  
                  <div style={{margin: '2rem 0'}}>
                    {viewedChinese ? (
                      <div className="explanation">
                        <strong>中文解释：</strong>{currentWord.chinese}
                      </div>
                    ) : (
                      <button className="btn" onClick={handleViewChinese}>
                        查看华语解释
                      </button>
                    )}
                    
                    {viewedEnglish ? (
                      <div className="explanation">
                        <strong>English:</strong> {currentWord.english}
                      </div>
                    ) : (
                      <button className="btn" onClick={handleViewEnglish}>
                        查看英文解释
                      </button>
                    )}
                  </div>
                  
                  {viewedChinese && viewedEnglish ? (
                    <div className="controls">
                      {currentWordIndex > 0 && (
                        <button className="btn btn-secondary" onClick={handlePreviousWord}>
                          ← 上一个词汇
                        </button>
                      )}
                      <button className="btn" onClick={handleNextWord}>
                        {currentWordIndex < getCurrentData().vocabulary.length - 1 ? '下一个词汇 →' : '开始练习 🎮'}
                      </button>
                    </div>
                  ) : (
                    <p style={{textAlign: 'center', color: '#666'}}>
                      请先查看华语和英文解释
                    </p>
                  )}
                </div>
              </div>
            );
          }

          // Game phase
          if (currentPhase === 'game') {
            const currentQ = getCurrentData().gameQuestions[currentQuestion];
            return (
              <div className="container">
                <button className="back-btn" onClick={backToMenu}>🏠 返回主页</button>
                
                <div className="header">
                  <h1 className="title">🎮 填空练习</h1>
                  <p className="subtitle">{chapterTitle}</p>
                </div>
                
                <div className="card game-card">
                  <div className="progress">
                    第 {currentQuestion + 1} 题 / {getCurrentData().gameQuestions.length} 题
                  </div>
                  
                  <div className="question">
                    <div className="question-text">{currentQ.text}</div>
                    <div className="question-english">{currentQ.english}</div>
                    <button className="btn" onClick={() => speakText(currentQ.text)}>
                      🔊 朗读题目
                    </button>
                  </div>
                  
                  <div className="options">
                    {currentQ.options.map((option, index) => (
                      <button 
                        key={index}
                        className="option-btn"
                        onClick={() => handleGameAnswer(option)}
                      >
                        {option}<br/>
                        <small>({currentQ.optionsEnglish[index]})</small>
                      </button>
                    ))}
                  </div>
                  
                  {wrongCount > 0 && (
                    <div style={{textAlign: 'center', color: 'red', fontWeight: 'bold'}}>
                      错误次数: {wrongCount}/3
                    </div>
                  )}
                  
                  <div className="controls">
                    <button className="btn btn-secondary" onClick={() => setCurrentPhase('learning')}>
                      📚 返回词汇学习
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          // Reading phase
          if (currentPhase === 'reading') {
            if (!isReading) {
              return (
                <div className="container">
                  <button className="back-btn" onClick={backToMenu}>🏠 返回主页</button>
                  
                  <div className="header">
                    <h1 className="title">📖 作文朗读</h1>
                    <p className="subtitle">{chapterTitle}</p>
                  </div>
                  
                  <div className="card reading-card">
                    <h2 style={{textAlign: 'center', marginBottom: '2rem'}}>
                      🎉 恭喜完成所有练习！
                    </h2>
                    <p style={{textAlign: 'center', fontSize: '1.2rem', marginBottom: '2rem'}}>
                      选择语言开始朗读故事：<br/>
                      Choose a language to read the story:
                    </p>
                    
                    <div className="controls">
                      <button className="btn" onClick={() => handleReading('chinese')}>
                        🇨🇳 中文朗读
                      </button>
                      <button className="btn" onClick={() => handleReading('english')}>
                        🇺🇸 英文朗读
                      </button>
                    </div>
                    
                    <div className="controls">
                      <button className="btn btn-secondary" onClick={() => resetChapterData()}>
                        🔄 重新开始本章
                      </button>
                    </div>
                  </div>
                </div>
              );
            } else {
              const sentences = readingLanguage === 'chinese' ? getCurrentData().chineseSentences : getCurrentData().englishSentences;
              
              return (
                <div className="container">
                  <button className="back-btn" onClick={backToMenu}>🏠 返回主页</button>
                  
                  <div className="header">
                    <h1 className="title">📖 {readingLanguage === 'chinese' ? '中文朗读' : 'English Reading'}</h1>
                    <p className="subtitle">{chapterTitle}</p>
                  </div>
                  
                  <div className="card reading-card">
                    <div className="progress">
                      第 {currentSentence + 1} 句 / {sentences.length} 句
                    </div>
                    
                    <div className="story-container">
                      {sentences.map((sentence, index) => (
                        <div 
                          key={index}
                          className={`sentence ${index === currentSentence ? 'current-sentence' : ''}`}
                        >
                          {sentence}
                        </div>
                      ))}
                    </div>
                    
                    <div className="controls">
                      <button className="btn" onClick={() => speakText(sentences[currentSentence], readingLanguage === 'chinese' ? 'zh-CN' : 'en-US')}>
                        🔊 重新朗读这句
                      </button>
                      <button className="btn" onClick={handleNextSentence}>
                        {currentSentence < sentences.length - 1 ? '下一句 →' : '完成朗读 ✅'}
                      </button>
                    </div>
                    
                    <div className="controls">
                      <button className="btn btn-secondary" onClick={() => {setIsReading(false); setReadingLanguage('');}}>
                        ← 返回选择语言
                      </button>
                    </div>
                  </div>
                </div>
              );
            }
          }

          return null;
        };

        // Render the app
        ReactDOM.render(<ChineseLearningCompleteApp />, document.getElementById('root'));
    </script>
</body>
</html>