<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åè¯­è¯æ±‡è¯­éŸ³å­¦ä¹ ç³»ç»Ÿ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }
        .page-indicator {
            font-size: 20px;
            color: #666;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            padding: 15px;
            border-radius: 25px;
            color: #333;
            font-weight: bold;
        }
        .vocab-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            padding: 50px;
            margin: 30px 0;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        .vocab-number {
            font-size: 24px;
            margin-bottom: 20px;
            color: #ffeb3b;
            font-weight: bold;
        }
        .vocab-word {
            font-size: 60px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .vocab-pinyin {
            font-size: 36px;
            margin-bottom: 30px;
            color: #ffeb3b;
            font-style: italic;
            font-weight: bold;
        }
        .vocab-meaning {
            font-size: 22px;
            line-height: 1.8;
            background: rgba(255,255,255,0.15);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }
        .chinese-meaning {
            color: #e8f5e8;
            margin-bottom: 20px;
            border-left: 4px solid #4CAF50;
            padding-left: 20px;
        }
        .english-meaning {
            color: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding-left: 20px;
        }
        .audio-controls {
            margin: 30px 0;
        }
        .audio-btn {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            color: white;
            border: none;
            padding: 20px 30px;
            margin: 10px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.3);
            transition: all 0.3s;
        }
        .audio-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 107, 107, 0.4);
        }
        .audio-btn:active {
            transform: translateY(0);
        }
        .audio-btn.playing {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .navigation {
            margin: 30px 0;
        }
        .nav-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 25px;
            margin: 0 10px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .nav-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .start-game-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 25px 50px;
            border-radius: 50px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3);
            transition: all 0.3s;
            margin: 20px;
        }
        .start-game-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(76, 175, 80, 0.4);
        }
        
        /* æ¸¸æˆæ ·å¼ */
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #2196F3);
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        .question-box {
            background: #f8f9fa;
            border-left: 5px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: left;
        }
        .chinese-sentence {
            font-size: 18px;
            color: #d32f2f;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .english-sentence {
            font-size: 16px;
            color: #1976d2;
            font-weight: bold;
        }
        .option-btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            line-height: 1.4;
        }
        .option-btn:hover {
            border-color: #007bff;
            background: #e3f2fd;
        }
        .option-btn.correct {
            background: #e8f5e8;
            border-color: #4CAF50;
            color: #2e7d32;
        }
        .option-btn.incorrect {
            background: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }
        .result-box {
            text-align: center;
            padding: 30px;
            margin: 20px 0;
            border-radius: 15px;
            font-size: 18px;
        }
        .success {
            background: #e8f5e8;
            border: 2px solid #4CAF50;
            color: #2e7d32;
        }
        .error {
            background: #ffebee;
            border: 2px solid #f44336;
            color: #c62828;
        }
        .celebration {
            font-size: 60px;
            margin: 10px 0;
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        .final-score {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <!-- å­¦ä¹ é¡µé¢ -->
    <div id="learning-section" class="container">
        <div class="page-indicator" id="page-indicator">
            ç¬¬ 1 é¡µ Page 1 / 10
        </div>
        
        <div class="vocab-display">
            <div class="vocab-number" id="vocab-number">1.</div>
            <div class="vocab-word" id="vocab-word">åŠæ³•</div>
            <div class="vocab-pinyin" id="vocab-pinyin">bÃ n fÇ</div>
            
            <!-- éšè—çš„æ„æ€åŒºåŸŸ -->
            <div class="vocab-meaning chinese-meaning" id="chinese-meaning" style="display: none;">
                å¤„ç†äº‹æƒ…æˆ–è§£å†³é—®é¢˜çš„æ–¹æ³•
            </div>
            <div class="vocab-meaning english-meaning" id="english-meaning" style="display: none;">
                means; method; way (of doing something)
            </div>
            
            <!-- æ˜¾ç¤ºæ„æ€çš„æŒ‰é’® -->
            <div id="meaning-buttons" style="margin: 20px 0;">
                <button class="audio-btn" onclick="showChineseMeaning()" id="show-chinese-btn" style="background: linear-gradient(45deg, #e91e63, #ad1457);">
                    ğŸ‘ï¸ æ˜¾ç¤ºä¸­æ–‡æ„æ€ Show Chinese Meaning
                </button>
                <button class="audio-btn" onclick="showEnglishMeaning()" id="show-english-btn" style="background: linear-gradient(45deg, #3f51b5, #283593);">
                    ğŸ‘ï¸ æ˜¾ç¤ºè‹±æ–‡æ„æ€ Show English Meaning
                </button>
            </div>
        </div>
        
        <div class="audio-controls">
            <button class="audio-btn" id="read-word-btn" onclick="readWord()">
                ğŸ”Š è¯»è¯è¯­ Read Word
            </button>
            <button class="audio-btn" id="read-chinese-btn" onclick="readChineseMeaning()">
                ğŸ”Š è¯»ä¸­æ–‡æ„æ€ Read Chinese Meaning
            </button>
            <button class="audio-btn" id="read-english-btn" onclick="readEnglishMeaning()">
                ğŸ”Š è¯»è‹±æ–‡æ„æ€ Read English Meaning
            </button>
        </div>
        
        <div class="navigation">
            <button class="nav-btn" id="prev-btn" onclick="prevPage()" disabled>
                â¬…ï¸ ä¸Šä¸€é¡µ Previous
            </button>
            <button class="nav-btn" id="next-btn" onclick="nextPage()">
                ä¸‹ä¸€é¡µ Next â¡ï¸
            </button>
        </div>
        
        <div id="game-ready" style="display: none;">
            <div style="background: #e8f5e8; padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid #4CAF50;">
                <h3 style="color: #2e7d32; margin: 0 0 10px 0;">ğŸ‰ å­¦ä¹ å®Œæˆï¼Learning Complete!</h3>
                <p style="color: #2e7d32; margin: 0;">ç°åœ¨å¯ä»¥å¼€å§‹ç»ƒä¹ æ¸¸æˆäº†ï¼Now you can start the practice game!</p>
            </div>
            <button class="start-game-btn" onclick="startGame()">
                ğŸ® å¼€å§‹ç»ƒä¹ æ¸¸æˆ Start Practice Game
            </button>
        </div>
    </div>

    <!-- æ¸¸æˆéƒ¨åˆ† -->
    <div id="game-section" class="container hidden">
        <h1 style="color: #333; margin-bottom: 30px;">
            ğŸ¯ åè¯­è¯æ±‡ç»ƒä¹ æ¸¸æˆ Chinese Vocabulary Game
        </h1>
        
        <div id="game-area">
            <!-- è¿›åº¦æ¡ -->
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span>è¿›åº¦ Progress</span>
                <span id="progress-text">1/10</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 10%"></div>
            </div>
            
            <!-- åˆ†æ•° -->
            <div style="text-align: right; margin-bottom: 20px; font-size: 16px; background: #fff3cd; padding: 10px; border-radius: 5px; border: 1px solid #ffeaa7;">
                ğŸ… å¾—åˆ† Score: <span id="current-score">0</span>/10
            </div>
            
            <!-- é¢˜ç›® -->
            <div class="question-box">
                <h3 id="question-number">ç¬¬ 1 é¢˜ Question 1</h3>
                <div class="chinese-sentence" id="chinese-text">å‡ ä¸ªå­©å­åœ¨ä¸€æ£µå¤§æ ‘ä¸‹æ‹çƒï¼Œä¸€ä¸ªä¸______ï¼Œçš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„æ ‘æ´é‡Œå»äº†ã€‚</div>
                <div class="english-sentence" id="english-text">Several children were bouncing a ball under a big tree. One of them wasn't ______ and the ball bounced into a hollow in the tree.</div>
            </div>
            
            <!-- é€‰é¡¹ -->
            <div style="margin: 20px 0;">
                <button class="option-btn" onclick="selectAnswer(0)">A) <span id="option-0">èªæ˜ (cÅng mÃ­ng)</span></button>
                <button class="option-btn" onclick="selectAnswer(1)">B) <span id="option-1">å°å¿ƒ (xiÇo xÄ«n)</span></button>
                <button class="option-btn" onclick="selectAnswer(2)">C) <span id="option-2">ç€æ€¥ (zhÃ¡o jÃ­)</span></button>
            </div>
            
            <!-- ç»“æœæ˜¾ç¤º -->
            <div id="result-area" style="display: none;"></div>
            
            <!-- ä¸‹ä¸€é¢˜æŒ‰é’® -->
            <div style="text-align: center;">
                <button class="nav-btn" id="next-question-btn" onclick="nextQuestion()" style="display: none;">
                    ä¸‹ä¸€é¢˜ Next Question ğŸš€
                </button>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="nav-btn" onclick="backToLearning()">ğŸ“– è¿”å›å­¦ä¹  Back to Learning</button>
            </div>
        </div>
        
        <!-- æœ€ç»ˆç»“æœ -->
        <div id="final-result" style="display: none;"></div>
    </div>

    <script>
        // è¯æ±‡æ•°æ®
        const vocabularyData = [
            {
                word: "åŠæ³•",
                pinyin: "bÃ n fÇ",
                chineseMeaning: "å¤„ç†äº‹æƒ…æˆ–è§£å†³é—®é¢˜çš„æ–¹æ³•",
                englishMeaning: "means; method; way (of doing something)"
            },
            {
                word: "è„‘ç­‹",
                pinyin: "nÇo jÄ«n",
                chineseMeaning: "æŒ‡æ€ç»´ã€è®°å¿†ç­‰èƒ½åŠ›ï¼Œä¹ŸæŒ‡äººçš„æ€æƒ³æˆ–ä¸»æ„",
                englishMeaning: "brains; mind"
            },
            {
                word: "æµ®",
                pinyin: "fÃº",
                chineseMeaning: "å› æ¯”é‡å°è€Œæ¼‚åœ¨æ¶²ä½“æˆ–æ°”ä½“è¡¨é¢çš„çŠ¶æ€",
                englishMeaning: "to float"
            },
            {
                word: "æ ‘æ´",
                pinyin: "shÃ¹ dÃ²ng",
                chineseMeaning: "æ ‘å¹²ä¸Šå½¢æˆçš„åŠå¼€æ”¾å­”ç©´ï¼Œå¯è¢«åŠ¨ç‰©ä½œå·¢",
                englishMeaning: "tree hollow"
            },
            {
                word: "ç€æ€¥",
                pinyin: "zhÃ¡o jÃ­",
                chineseMeaning: "æ€¥èºã€å¿ƒä¸­ä¸å®‰ï¼Œä¹Ÿæœ‰èµ¶ç´§ä¹‹æ„",
                englishMeaning: "to be anxious; to worry"
            },
            {
                word: "æƒ…å½¢",
                pinyin: "qÃ­ng xÃ­ng",
                chineseMeaning: "äº‹æƒ…çš„æ ·å­ã€æƒ…å†µæˆ–çŠ¶æ€",
                englishMeaning: "situation; condition; circumstances"
            },
            {
                word: "å°å¿ƒ",
                pinyin: "xiÇo xÄ«n",
                chineseMeaning: "ç•™ç¥ã€è°¨æ…ã€ç»†å¿ƒ",
                englishMeaning: "careful; to take care; caution"
            },
            {
                word: "æ ‘æ",
                pinyin: "shÃ¹ zhÄ«",
                chineseMeaning: "æ ‘æœ¨çš„ææ¡",
                englishMeaning: "branch (of a tree); twig"
            },
            {
                word: "èªæ˜",
                pinyin: "cÅng mÃ­ng",
                chineseMeaning: "æ™ºåŠ›å‘è¾¾ï¼Œç†è§£èƒ½åŠ›å¼ºï¼Œæœºæ•",
                englishMeaning: "intelligent; clever; bright; smart"
            },
            {
                word: "æ",
                pinyin: "tÃ­",
                chineseMeaning: "å‚æ‰‹æ‹¿ç€æœ‰ç¯æˆ–æŠŠçš„ä¸œè¥¿ï¼›ä¹ŸæŒ‡æèµ·ã€æå‡º",
                englishMeaning: "to carry (hanging down with the hand); to lift; to raise; to bring up"
            }
        ];

        // æ¸¸æˆæ•°æ®
        const questions = [
            {
                chinese: "å‡ ä¸ªå­©å­åœ¨ä¸€æ£µå¤§æ ‘ä¸‹æ‹çƒï¼Œä¸€ä¸ªä¸______ï¼Œçš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„æ ‘æ´é‡Œå»äº†ã€‚",
                english: "Several children were bouncing a ball under a big tree. One of them wasn't ______ and the ball bounced into a hollow in the tree.",
                options: [
                    { chinese: "èªæ˜ (cÅng mÃ­ng)", english: "intelligent; clever", isCorrect: false },
                    { chinese: "å°å¿ƒ (xiÇo xÄ«n)", english: "careful; caution", isCorrect: true },
                    { chinese: "ç€æ€¥ (zhÃ¡o jÃ­)", english: "anxious; worry", isCorrect: false }
                ],
                correct: 1
            },
            {
                chinese: "å‡ ä¸ªå­©å­åœ¨ä¸€æ£µå¤§æ ‘ä¸‹æ‹çƒï¼Œä¸€ä¸ªä¸å°å¿ƒï¼Œçš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„______é‡Œå»äº†ã€‚",
                english: "Several children were bouncing a ball under a big tree. One of them wasn't careful and the ball bounced into a ______ in the tree.",
                options: [
                    { chinese: "æ ‘æ (shÃ¹ zhÄ«)", english: "branch; twig", isCorrect: false },
                    { chinese: "æ ‘æ´ (shÃ¹ dÃ²ng)", english: "tree hollow", isCorrect: true },
                    { chinese: "è„‘ç­‹ (nÇo jÄ«n)", english: "brains; mind", isCorrect: false }
                ],
                correct: 1
            },
            {
                chinese: "å¤§å®¶å¾ˆ______ï¼Œäº‰ç€æŠŠæ‰‹ä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒã€‚",
                english: "They all got ______ and took turns reaching into the hole for the ball.",
                options: [
                    { chinese: "èªæ˜ (cÅng mÃ­ng)", english: "intelligent; clever", isCorrect: false },
                    { chinese: "å°å¿ƒ (xiÇo xÄ«n)", english: "careful; caution", isCorrect: false },
                    { chinese: "ç€æ€¥ (zhÃ¡o jÃ­)", english: "anxious; worry", isCorrect: true }
                ],
                correct: 2
            },
            {
                chinese: "æœ‰äººæ‰¾æ¥ä¸€æ ¹______ï¼Œä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒã€‚",
                english: "Someone fetched a ______ and tried to hook the ball.",
                options: [
                    { chinese: "æ ‘æ (shÃ¹ zhÄ«)", english: "branch; twig", isCorrect: true },
                    { chinese: "æ ‘æ´ (shÃ¹ dÃ²ng)", english: "tree hollow", isCorrect: false },
                    { chinese: "åŠæ³• (bÃ n fÇ)", english: "method; way", isCorrect: false }
                ],
                correct: 0
            },
            {
                chinese: "å¯æ˜¯çƒå¤ªæ»‘äº†ï¼Œä¹Ÿæ²¡æœ‰______æŠŠå®ƒæ‹¿ä¸Šæ¥ã€‚",
                english: "But it was too slippery and they still had no ______ to retrieve it.",
                options: [
                    { chinese: "æƒ…å½¢ (qÃ­ng xÃ­ng)", english: "situation; condition", isCorrect: false },
                    { chinese: "åŠæ³• (bÃ n fÇ)", english: "method; way", isCorrect: true },
                    { chinese: "è„‘ç­‹ (nÇo jÄ«n)", english: "brains; mind", isCorrect: false }
                ],
                correct: 1
            },
            {
                chinese: "åå›½æ˜¯ä¸ª______çš„å­©å­ï¼Œå¹³æ—¶æœ€çˆ±åŠ¨è„‘ç­‹ã€‚",
                english: "Hua Guo was a ______ child who liked to use his brain.",
                options: [
                    { chinese: "å°å¿ƒ (xiÇo xÄ«n)", english: "careful; caution", isCorrect: false },
                    { chinese: "ç€æ€¥ (zhÃ¡o jÃ­)", english: "anxious; worry", isCorrect: false },
                    { chinese: "èªæ˜ (cÅng mÃ­ng)", english: "intelligent; clever", isCorrect: true }
                ],
                correct: 2
            },
            {
                chinese: "åå›½æ˜¯ä¸ªèªæ˜çš„å­©å­ï¼Œå¹³æ—¶æœ€çˆ±åŠ¨______ã€‚",
                english: "Hua Guo was a clever child who liked to use his ______.",
                options: [
                    { chinese: "è„‘ç­‹ (nÇo jÄ«n)", english: "brains; mind", isCorrect: true },
                    { chinese: "æ ‘æ (shÃ¹ zhÄ«)", english: "branch; twig", isCorrect: false },
                    { chinese: "åŠæ³• (bÃ n fÇ)", english: "method; way", isCorrect: false }
                ],
                correct: 0
            },
            {
                chinese: "ä»–çœ‹åˆ°è¿™ç§______ï¼Œåªè§ä»–çœ¼ç å­ä¸€è½¬ï¼Œå°±æƒ³åˆ°åŠæ³•äº†ã€‚",
                english: "When he saw the ______, his eyes turned and he thought of an idea.",
                options: [
                    { chinese: "æ ‘æ´ (shÃ¹ dÃ²ng)", english: "tree hollow", isCorrect: false },
                    { chinese: "æƒ…å½¢ (qÃ­ng xÃ­ng)", english: "situation; condition", isCorrect: true },
                    { chinese: "ç€æ€¥ (zhÃ¡o jÃ­)", english: "anxious; worry", isCorrect: false }
                ],
                correct: 1
            },
            {
                chinese: "ä»–è·‘å›å®¶å»ï¼Œä¸ä¹…ï¼Œ______æ¥äº†ä¸€æ¡¶æ°´ã€‚",
                english: "He ran home and soon came back ______ a bucket of water.",
                options: [
                    { chinese: "æµ® (fÃº)", english: "to float", isCorrect: false },
                    { chinese: "æ (tÃ­)", english: "to carry; to lift", isCorrect: true },
                    { chinese: "å°å¿ƒ (xiÇo xÄ«n)", english: "careful; caution", isCorrect: false }
                ],
                correct: 1
            },
            {
                chinese: "ä»–æŠŠæ°´å€’è¿›æ ‘æ´é‡Œï¼Œçš®çƒ______äº†ä¸Šæ¥ï¼Œä»–å°±è½»æ˜“åœ°å°±æ‹¿åˆ°çƒäº†ã€‚",
                english: "He poured the water into the tree hollow. The ball ______ up, and he easily picked it up.",
                options: [
                    { chinese: "æ (tÃ­)", english: "to carry; to lift", isCorrect: false },
                    { chinese: "æµ® (fÃº)", english: "to float", isCorrect: true },
                    { chinese: "èªæ˜ (cÅng mÃ­ng)", english: "intelligent; clever", isCorrect: false }
                ],
                correct: 1
            }
        ];

        // å­¦ä¹ é¡µé¢å˜é‡
        let currentPage = 0;
        let chineseMeaningShown = false; // è·Ÿè¸ªä¸­æ–‡æ„æ€æ˜¯å¦å·²æ˜¾ç¤º
        let englishMeaningShown = false; // è·Ÿè¸ªè‹±æ–‡æ„æ€æ˜¯å¦å·²æ˜¾ç¤º
        
        // æ¸¸æˆå˜é‡
        let currentQuestion = 0;
        let score = 0;
        let answered = false;
        let attempts = 0; // æ·»åŠ å°è¯•æ¬¡æ•°
        const maxAttempts = 2; // æ¯é¢˜æœ€å¤š2æ¬¡æœºä¼š
        let consecutiveWrong = 0; // è¿ç»­ç­”é”™çš„é¢˜æ•°

        const celebrationIcons = ['ğŸ‰', 'ğŸŒŸ', 'ğŸˆ', 'ğŸ¦„', 'ğŸŒˆ', 'ğŸ°', 'ğŸ±', 'ğŸŠ', 'ğŸ’«', 'ğŸ†', 'ğŸ‘', 'ğŸ˜Š', 'ğŸ', 'ğŸš€', 'ğŸ¦‹', 'ğŸŒ¸'];
        const encouragementMessages = ['å¤ªæ£’äº†ï¼', 'ä½ çœŸèªæ˜ï¼', 'åšå¾—å¾ˆå¥½ï¼', 'ç»§ç»­åŠ æ²¹ï¼', 'Amazing!', 'Well done!', 'Excellent!', 'ä½ æ˜¯æœ€æ£’çš„ï¼'];
        const correctSounds = ['å¤ªæ£’äº†ï¼', 'ä½ çœŸèªæ˜ï¼', 'åšå¾—å¾ˆå¥½ï¼', 'ç»§ç»­åŠ æ²¹ï¼', 'å¾ˆæ£’ï¼', 'å¤ªå‰å®³äº†ï¼', 'ç­”å¯¹äº†ï¼'];
        const incorrectSounds = ['å†æ¥ä¸€æ¬¡', 'åŠ æ²¹', 'ä¸è¦ç°å¿ƒï¼Œå†ä¸€æ¬¡', 'ç»§ç»­åŠªåŠ›', 'æ²¡å…³ç³»ï¼Œå†è¯•è¯•', 'åŠ æ²¹ï¼Œä½ å¯ä»¥çš„ï¼'];

        // å®Œæ•´ä½œæ–‡ï¼ˆæŒ‰å¥å­åˆ†å‰²ä¾¿äºé«˜äº®ï¼‰
        const fullStorySegments = [
            "å‡ ä¸ªå­©å­åœ¨ä¸€æ£µå¤§æ ‘ä¸‹æ‹çƒï¼Œä¸€ä¸ªä¸å°å¿ƒï¼Œçš®çƒè·³è¿›ä¸€æ£µå¤§æ ‘çš„æ ‘æ´é‡Œå»äº†ã€‚",
            "å¤§å®¶å¾ˆç€æ€¥ï¼Œäº‰ç€æŠŠæ‰‹ä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒã€‚",
            "å¯æ˜¯ï¼Œä»–ä»¬çš„æ‰‹å¤ªçŸ­äº†ï¼Œæ²¡æœ‰äººèƒ½æŠŠçš®çƒæ‹¿ä¸Šæ¥ã€‚",
            "æœ‰äººæ‰¾æ¥ä¸€æ ¹æ ‘æï¼Œä¼¸è¿›æ ‘æ´é‡Œå»æ‹¿çƒï¼Œå¯æ˜¯çƒå¤ªæ»‘äº†ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•æŠŠå®ƒæ‹¿ä¸Šæ¥ã€‚",
            "å¤§å®¶æ€¥å¾—å¿«å“­å‡ºæ¥äº†ã€‚",
            "åå›½æ˜¯ä¸ªèªæ˜çš„å­©å­ï¼Œå¹³æ—¶æœ€çˆ±åŠ¨è„‘ç­‹ã€‚",
            "ä»–çœ‹åˆ°è¿™ç§æƒ…å½¢ï¼Œåªè§ä»–çœ¼ç å­ä¸€è½¬ï¼Œå°±æƒ³åˆ°åŠæ³•äº†ã€‚",
            "ä»–è·‘å›å®¶å»ï¼Œä¸ä¹…ï¼Œææ¥äº†ä¸€æ¡¶æ°´ã€‚",
            "ä»–æŠŠæ°´å€’è¿›æ ‘æ´é‡Œï¼Œçš®çƒæµ®äº†ä¸Šæ¥ï¼Œä»–å°±è½»æ˜“åœ°å°±æ‹¿åˆ°çƒäº†ã€‚"
        ];

        const fullStoryEnglishSegments = [
            "Several children were bouncing a ball under a big tree.",
            "One of them wasn't careful and the ball bounced into a hollow in the tree.",
            "They all got anxious and took turns reaching into the hole for the ball, but their arms were too short and nobody could get it out.",
            "Someone fetched a tree branch and tried to hook the ball, but it was too slippery and they still had no way to retrieve it.",
            "The children were so worried that they were almost in tears.",
            "Hua Guo was a clever child who liked to use his brain.",
            "When he saw the situation, his eyes turned and he thought of an idea.",
            "He ran home and soon came back carrying a bucket of water.",
            "He poured the water into the tree hollow.",
            "The ball floated up, and he easily picked it up."
        ];

        // è¯­éŸ³åˆæˆåŠŸèƒ½ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
        function speak(text, lang = 'zh-CN') {
            return new Promise((resolve) => {
                if ('speechSynthesis' in window) {
                    // åœæ­¢å½“å‰æ’­æ”¾
                    speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = lang;
                    utterance.rate = 0.8; // å­¦ä¹ æ—¶ç¨æ…¢ï¼Œæ•…äº‹æœ—è¯»æ—¶ä¼šç‰¹åˆ«è°ƒæ•´
                    utterance.volume = 1;
                    
                    // å¯¹äºä¸­æ–‡ï¼Œå°è¯•é€‰æ‹©ä¸­æ–‡è¯­éŸ³
                    if (lang === 'zh-CN') {
                        const voices = speechSynthesis.getVoices();
                        const chineseVoice = voices.find(voice => 
                            voice.lang.includes('zh') || 
                            voice.name.includes('Chinese') ||
                            voice.name.includes('ä¸­æ–‡')
                        );
                        if (chineseVoice) {
                            utterance.voice = chineseVoice;
                        }
                    }
                    
                    utterance.onend = () => {
                        resolve();
                    };
                    
                    utterance.onerror = () => {
                        resolve();
                    };
                    
                    speechSynthesis.speak(utterance);
                } else {
                    alert('æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åŠŸèƒ½ã€‚Sorry, your browser doesn\'t support speech synthesis.');
                    resolve();
                }
            });
        }

        // æ•…äº‹æœ—è¯»ä¸“ç”¨è¯­éŸ³å‡½æ•°ï¼ˆæ­£å¸¸è¯­é€Ÿï¼‰
        function speakStory(text, lang = 'zh-CN') {
            return new Promise((resolve) => {
                if ('speechSynthesis' in window) {
                    speechSynthesis.cancel();
                    
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = lang;
                    utterance.rate = 1.0; // æ­£å¸¸è¯­é€Ÿ
                    utterance.volume = 1;
                    
                    if (lang === 'zh-CN') {
                        const voices = speechSynthesis.getVoices();
                        const chineseVoice = voices.find(voice => 
                            voice.lang.includes('zh') || 
                            voice.name.includes('Chinese') ||
                            voice.name.includes('ä¸­æ–‡')
                        );
                        if (chineseVoice) {
                            utterance.voice = chineseVoice;
                        }
                    }
                    
                    utterance.onend = () => {
                        resolve();
                    };
                    
                    utterance.onerror = () => {
                        resolve();
                    };
                    
                    speechSynthesis.speak(utterance);
                } else {
                    resolve();
                }
            });
        }

        // æœ—è¯»åŠŸèƒ½ï¼ˆåˆ†å¼€è¯»ï¼Œé¿å…æ‹¼éŸ³é—®é¢˜ï¼‰
        async function readWord() {
            const btn = document.getElementById('read-word-btn');
            btn.classList.add('playing');
            
            const vocab = vocabularyData[currentPage];
            // åªè¯»ä¸­æ–‡è¯è¯­ï¼Œä¸è¯»æ‹¼éŸ³
            await speak(vocab.word, 'zh-CN');
            
            btn.classList.remove('playing');
        }

        async function readChineseMeaning() {
            const btn = document.getElementById('read-chinese-btn');
            btn.classList.add('playing');
            
            const vocab = vocabularyData[currentPage];
            await speak(vocab.chineseMeaning, 'zh-CN');
            
            btn.classList.remove('playing');
        }

        async function readEnglishMeaning() {
            const btn = document.getElementById('read-english-btn');
            btn.classList.add('playing');
            
            const vocab = vocabularyData[currentPage];
            await speak(vocab.englishMeaning, 'en-US');
            
            btn.classList.remove('playing');
        }

        // å­¦ä¹ åŠŸèƒ½
        // æ˜¾ç¤ºå¹¶æœ—è¯»ä¸­æ–‡æ„æ€
        async function showChineseMeaning() {
            const chineseMeaning = document.getElementById('chinese-meaning');
            const btn = document.getElementById('show-chinese-btn');
            const vocab = vocabularyData[currentPage];
            
            // æ˜¾ç¤ºæ„æ€
            chineseMeaning.style.display = 'block';
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            btn.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
            btn.textContent = 'ğŸ”Š æ­£åœ¨æœ—è¯»ä¸­æ–‡æ„æ€...';
            btn.disabled = true;
            
            // æœ—è¯»ä¸­æ–‡æ„æ€
            await speak(vocab.chineseMeaning, 'zh-CN');
            
            // æœ—è¯»å®Œæˆåæ›´æ–°æŒ‰é’®å’ŒçŠ¶æ€
            btn.textContent = 'âœ… å·²æ˜¾ç¤ºå¹¶æœ—è¯»ä¸­æ–‡æ„æ€';
            chineseMeaningShown = true;
            updateNextButtonState();
        }

        // æ˜¾ç¤ºå¹¶æœ—è¯»è‹±æ–‡æ„æ€
        async function showEnglishMeaning() {
            const englishMeaning = document.getElementById('english-meaning');
            const btn = document.getElementById('show-english-btn');
            const vocab = vocabularyData[currentPage];
            
            // æ˜¾ç¤ºæ„æ€
            englishMeaning.style.display = 'block';
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            btn.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
            btn.textContent = 'ğŸ”Š Reading English Meaning...';
            btn.disabled = true;
            
            // æœ—è¯»è‹±æ–‡æ„æ€
            await speak(vocab.englishMeaning, 'en-US');
            
            // æœ—è¯»å®Œæˆåæ›´æ–°æŒ‰é’®å’ŒçŠ¶æ€
            btn.textContent = 'âœ… å·²æ˜¾ç¤ºå¹¶æœ—è¯»è‹±æ–‡æ„æ€';
            englishMeaningShown = true;
            updateNextButtonState();
        }

        // æ›´æ–°ä¸‹ä¸€é¡µæŒ‰é’®çŠ¶æ€
        function updateNextButtonState() {
            const nextBtn = document.getElementById('next-btn');
            const gameReadyDiv = document.getElementById('game-ready');
            
            if (chineseMeaningShown && englishMeaningShown) {
                // ä¸¤ä¸ªæ„æ€éƒ½å·²æ˜¾ç¤ºï¼Œå¯ä»¥è¿›å…¥ä¸‹ä¸€é¡µ
                if (currentPage === vocabularyData.length - 1) {
                    nextBtn.style.display = 'none';
                    gameReadyDiv.style.display = 'block';
                } else {
                    nextBtn.style.display = 'inline-block';
                    nextBtn.disabled = false;
                    nextBtn.style.background = '#007bff';
                    nextBtn.textContent = 'ä¸‹ä¸€é¡µ Next â¡ï¸';
                }
            } else {
                // è¿˜æœ‰æ„æ€æœªæ˜¾ç¤ºï¼Œç¦ç”¨ä¸‹ä¸€é¡µæŒ‰é’®
                nextBtn.disabled = true;
                nextBtn.style.background = '#ccc';
                nextBtn.textContent = 'è¯·å…ˆæŸ¥çœ‹ä¸¤ä¸ªæ„æ€ Please check both meanings first';
                gameReadyDiv.style.display = 'none';
            }
        }

        function loadVocabPage() {
            const vocab = vocabularyData[currentPage];
            
            document.getElementById('vocab-number').textContent = `${currentPage + 1}.`;
            document.getElementById('vocab-word').textContent = vocab.word;
            document.getElementById('vocab-pinyin').textContent = vocab.pinyin;
            document.getElementById('chinese-meaning').textContent = vocab.chineseMeaning;
            document.getElementById('english-meaning').textContent = vocab.englishMeaning;
            
            // é‡ç½®æ„æ€æ˜¾ç¤ºçŠ¶æ€
            document.getElementById('chinese-meaning').style.display = 'none';
            document.getElementById('english-meaning').style.display = 'none';
            chineseMeaningShown = false;
            englishMeaningShown = false;
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            const showChineseBtn = document.getElementById('show-chinese-btn');
            const showEnglishBtn = document.getElementById('show-english-btn');
            
            showChineseBtn.style.background = 'linear-gradient(45deg, #e91e63, #ad1457)';
            showChineseBtn.textContent = 'ğŸ‘ï¸ æ˜¾ç¤ºä¸­æ–‡æ„æ€ Show Chinese Meaning';
            showChineseBtn.disabled = false;
            
            showEnglishBtn.style.background = 'linear-gradient(45deg, #3f51b5, #283593)';
            showEnglishBtn.textContent = 'ğŸ‘ï¸ æ˜¾ç¤ºè‹±æ–‡æ„æ€ Show English Meaning';
            showEnglishBtn.disabled = false;
            
            document.getElementById('page-indicator').textContent = `ç¬¬ ${currentPage + 1} é¡µ Page ${currentPage + 1} / 10`;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('prev-btn').disabled = currentPage === 0;
            
            // è°ƒç”¨æ›´æ–°ä¸‹ä¸€é¡µæŒ‰é’®çŠ¶æ€ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰
            updateNextButtonState();
        }

        function prevPage() {
            if (currentPage > 0) {
                currentPage--;
                loadVocabPage();
            }
        }

        function nextPage() {
            if (currentPage < vocabularyData.length - 1) {
                currentPage++;
                loadVocabPage();
            }
        }

        function showSection(sectionId) {
            document.getElementById('learning-section').classList.add('hidden');
            document.getElementById('game-section').classList.add('hidden');
            document.getElementById(sectionId).classList.remove('hidden');
        }

        function backToLearning() {
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            currentQuestion = 0;
            score = 0;
            answered = false;
            attempts = 0;
            consecutiveWrong = 0;
            document.getElementById('game-area').style.display = 'block';
            document.getElementById('final-result').style.display = 'none';
            showSection('learning-section');
        }

        // æ¸¸æˆåŠŸèƒ½
        function startGame() {
            currentQuestion = 0;
            score = 0;
            answered = false;
            attempts = 0;
            consecutiveWrong = 0;
            showSection('game-section');
            document.getElementById('game-area').style.display = 'block';
            document.getElementById('final-result').style.display = 'none';
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            document.getElementById('question-number').textContent = `ç¬¬ ${currentQuestion + 1} é¢˜ Question ${currentQuestion + 1}`;
            document.getElementById('chinese-text').textContent = q.chinese;
            document.getElementById('english-text').textContent = q.english;
            
            for (let i = 0; i < 3; i++) {
                const optionElement = document.getElementById(`option-${i}`);
                optionElement.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 5px;">${q.options[i].chinese}</div>
                    <div style="font-size: 14px; color: #666; font-style: italic;">${q.options[i].english}</div>
                `;
            }
            
            // æ›´æ–°è¿›åº¦
            document.getElementById('progress-text').textContent = `${currentQuestion + 1}/10`;
            document.getElementById('progress-fill').style.width = `${((currentQuestion + 1) / 10) * 100}%`;
            document.getElementById('current-score').textContent = score;
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => {
                btn.className = 'option-btn';
                btn.disabled = false;
            });
            
            document.getElementById('result-area').style.display = 'none';
            document.getElementById('next-question-btn').style.display = 'none';
            answered = false;
            attempts = 0; // é‡ç½®å°è¯•æ¬¡æ•°
        }

        function selectAnswer(selected) {
            if (answered) return;
            
            attempts++;
            const q = questions[currentQuestion];
            const isCorrect = selected === q.correct;
            
            if (isCorrect) {
                // ç­”å¯¹äº†
                answered = true;
                score++;
                consecutiveWrong = 0; // é‡ç½®è¿ç»­é”™è¯¯è®¡æ•°
                const buttons = document.querySelectorAll('.option-btn');
                buttons.forEach(btn => btn.disabled = true);
                buttons[q.correct].classList.add('correct');
                
                const randomIcon = celebrationIcons[Math.floor(Math.random() * celebrationIcons.length)];
                const randomMessage = encouragementMessages[Math.floor(Math.random() * encouragementMessages.length)];
                const randomSound = correctSounds[Math.floor(Math.random() * correctSounds.length)];
                
                // æ’­æ”¾æˆåŠŸå£°éŸ³
                speak(randomSound, 'zh-CN');
                
                const resultArea = document.getElementById('result-area');
                resultArea.innerHTML = `
                    <div class="result-box success">
                        <div class="celebration">${randomIcon}</div>
                        <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">${randomMessage}</div>
                        <div>ç­”å¯¹äº†ï¼Correct! ${attempts === 1 ? 'ä¸€æ¬¡å°±å¯¹äº†ï¼' : 'ç¬¬äºŒæ¬¡ç­”å¯¹äº†ï¼'}</div>
                    </div>
                `;
                resultArea.style.display = 'block';
                
                // æ˜¾ç¤ºä¸‹ä¸€é¢˜æŒ‰é’®
                const nextBtn = document.getElementById('next-question-btn');
                if (currentQuestion < questions.length - 1) {
                    nextBtn.textContent = 'ä¸‹ä¸€é¢˜ Next Question ğŸš€';
                } else {
                    nextBtn.textContent = 'æŸ¥çœ‹ç»“æœ See Results ğŸ¯';
                }
                nextBtn.style.display = 'block';
                
            } else {
                // ç­”é”™äº†
                const buttons = document.querySelectorAll('.option-btn');
                buttons[selected].classList.add('incorrect');
                
                if (attempts < maxAttempts) {
                    // è¿˜æœ‰æœºä¼šï¼Œæ˜¾ç¤ºé¼“åŠ±ä¿¡æ¯å’Œå†è¯•ä¸€æ¬¡æŒ‰é’®
                    const randomSound = incorrectSounds[Math.floor(Math.random() * incorrectSounds.length)];
                    speak(randomSound, 'zh-CN');
                    
                    const resultArea = document.getElementById('result-area');
                    resultArea.innerHTML = `
                        <div class="result-box error">
                            <div style="font-size: 40px; margin: 10px 0;">ğŸ’ª</div>
                            <div style="font-weight: bold; margin: 10px 0;">æ²¡å…³ç³»ï¼è¿˜æœ‰ä¸€æ¬¡æœºä¼šï¼</div>
                            <div style="margin: 15px 0;">Don't worry! You have one more chance!</div>
                            <button class="nav-btn" onclick="tryAgain()" style="background: #ff9800; margin-top: 15px;">
                                ğŸ”„ å†è¯•ä¸€æ¬¡ Try Again
                            </button>
                        </div>
                    `;
                    resultArea.style.display = 'block';
                    
                    // ç¦ç”¨å·²é€‰æ‹©çš„é”™è¯¯ç­”æ¡ˆ
                    buttons[selected].disabled = true;
                    
                } else {
                    // ä¸¤æ¬¡éƒ½ç­”é”™äº†
                    answered = true;
                    consecutiveWrong++; // å¢åŠ è¿ç»­é”™è¯¯è®¡æ•°
                    buttons.forEach(btn => btn.disabled = true);
                    buttons[q.correct].classList.add('correct');
                    
                    // æ£€æŸ¥æ˜¯å¦è¿ç»­é”™è¯¯3é¢˜
                    if (consecutiveWrong >= 3) {
                        speak('è¿ç»­ç­”é”™ä¸‰é¢˜ï¼Œè®©æˆ‘ä»¬é‡æ–°å¼€å§‹å­¦ä¹ å§ï¼', 'zh-CN');
                        
                        const resultArea = document.getElementById('result-area');
                        resultArea.innerHTML = `
                            <div class="result-box error">
                                <div style="font-size: 40px; margin: 10px 0;">ğŸ˜…</div>
                                <div style="font-weight: bold; margin: 10px 0; color: #ff5722;">è¿ç»­ç­”é”™ä¸‰é¢˜äº†ï¼</div>
                                <div style="margin: 15px 0;">è®©æˆ‘ä»¬é‡æ–°å­¦ä¹ è¿™äº›è¯æ±‡å§ï¼<br>Let's review these vocabulary words again!</div>
                                <button class="nav-btn" onclick="restartGame()" style="background: #ff5722; margin-top: 15px;">
                                    ğŸ”„ é‡æ–°å¼€å§‹æ¸¸æˆ Restart Game
                                </button>
                            </div>
                        `;
                        resultArea.style.display = 'block';
                        return;
                    }
                    
                    speak('æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ­£ç¡®ç­”æ¡ˆå§', 'zh-CN');
                    
                    const correctAnswer = q.options[q.correct];
                    const resultArea = document.getElementById('result-area');
                    resultArea.innerHTML = `
                        <div class="result-box error">
                            <div style="font-size: 40px; margin: 10px 0;">ğŸ¤”</div>
                            <div style="font-weight: bold; margin: 10px 0;">æ²¡å…³ç³»ï¼Œæˆ‘ä»¬å­¦åˆ°äº†æ–°çŸ¥è¯†ï¼</div>
                            <div>æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼šCorrect answer is: 
                                <div style="margin-top: 10px; padding: 10px; background: rgba(76, 175, 80, 0.1); border-radius: 8px;">
                                    <strong>${correctAnswer.chinese}</strong><br>
                                    <span style="font-size: 14px; color: #666; font-style: italic;">${correctAnswer.english}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    resultArea.style.display = 'block';
                    
                    // æ˜¾ç¤ºä¸‹ä¸€é¢˜æŒ‰é’®
                    const nextBtn = document.getElementById('next-question-btn');
                    if (currentQuestion < questions.length - 1) {
                        nextBtn.textContent = 'ä¸‹ä¸€é¢˜ Next Question ğŸš€';
                    } else {
                        nextBtn.textContent = 'æŸ¥çœ‹ç»“æœ See Results ğŸ¯';
                    }
                    nextBtn.style.display = 'block';
                }
            }
            
            document.getElementById('current-score').textContent = score;
        }

        // é‡æ–°å¼€å§‹æ¸¸æˆå‡½æ•°
        function restartGame() {
            currentQuestion = 0;
            score = 0;
            answered = false;
            attempts = 0;
            consecutiveWrong = 0;
            document.getElementById('result-area').style.display = 'none';
            loadQuestion();
        }

        function tryAgain() {
            // é‡ç½®ç»“æœåŒºåŸŸï¼Œè®©å­©å­å¯ä»¥å†é€‰æ‹©
            document.getElementById('result-area').style.display = 'none';
            
            // é‡æ–°å¯ç”¨æœªè¢«ç¦ç”¨çš„æŒ‰é’®
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => {
                if (!btn.disabled) {
                    btn.classList.remove('incorrect');
                }
            });
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showFinalResult();
            }
        }

        function showFinalResult() {
            const percentage = Math.round((score / questions.length) * 100);
            let icon, message, stars;
            
            if (percentage >= 80) {
                icon = 'ğŸ†';
                message = 'ğŸ‰ å¤ªæ£’äº†ï¼ä½ æ˜¯åè¯­å°å¤©æ‰ï¼ Excellent! You\'re a Chinese vocabulary star! ğŸ‰';
                stars = 'â­'.repeat(5);
            } else if (percentage >= 60) {
                icon = 'ğŸŒŸ';
                message = 'ğŸ‘ åšå¾—å¾ˆå¥½ï¼ç»§ç»­åŠ æ²¹ï¼ Well done! Keep it up! ğŸ‘';
                stars = 'â­'.repeat(Math.floor(percentage / 20));
            } else {
                icon = 'ğŸˆ';
                message = 'ğŸ’ª ç»§ç»­ç»ƒä¹ ï¼Œä½ ä¼šè¶Šæ¥è¶Šæ£’ï¼ Keep practicing, you\'ll get better! ğŸ’ª';
                stars = 'â­'.repeat(Math.max(1, Math.floor(percentage / 20)));
            }
            
            document.getElementById('game-area').style.display = 'none';
            document.getElementById('final-result').innerHTML = `
                <div class="final-score">
                    <div style="font-size: 80px; margin: 20px 0;">${icon}</div>
                    <h2 style="margin: 20px 0;">æ¸¸æˆå®Œæˆï¼Game Complete!</h2>
                    <div style="font-size: 40px; margin: 20px 0;">${stars}</div>
                    <div style="font-size: 24px; margin: 15px 0;">ä½ çš„å¾—åˆ† Your Score: ${score}/${questions.length}</div>
                    <div style="font-size: 20px; margin: 15px 0;">æ­£ç¡®ç‡ Accuracy: ${percentage}%</div>
                    <div style="font-size: 18px; margin: 25px 0; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        ${message}
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 15px; margin: 25px 0; border: 2px solid rgba(255,255,255,0.3);">
                        <h3 style="margin: 0 0 15px 0; color: #ffeb3b;">ğŸ“– å¬å®Œæ•´æ•…äº‹ Listen to Full Story</h3>
                        <p style="margin: 0 0 15px 0; font-size: 16px;">ç°åœ¨æ¥å¬å¬è¿™ä¸ªèªæ˜çš„åå›½å¦‚ä½•å–çƒçš„å®Œæ•´æ•…äº‹å§ï¼</p>
                        
                        <!-- ä¸­æ–‡æ•…äº‹æ–‡å­—åŒºåŸŸ -->
                        <div id="chinese-story-area" style="display: none; background: rgba(255,255,255,0.9); padding: 20px; border-radius: 10px; margin: 15px 0; color: #333; text-align: left; line-height: 2;">
                            <h4 style="color: #d32f2f; margin: 0 0 15px 0;">ğŸ“– ä¸­æ–‡æ•…äº‹ Chinese Story</h4>
                            <div id="chinese-story-text" style="font-size: 18px;">
                                ${fullStorySegments.map((segment, index) => 
                                    `<span id="chinese-segment-${index}" style="transition: all 0.3s ease;">${segment}</span>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <!-- è‹±æ–‡æ•…äº‹æ–‡å­—åŒºåŸŸ -->
                        <div id="english-story-area" style="display: none; background: rgba(255,255,255,0.9); padding: 20px; border-radius: 10px; margin: 15px 0; color: #333; text-align: left; line-height: 2;">
                            <h4 style="color: #1976d2; margin: 0 0 15px 0;">ğŸ“– è‹±æ–‡æ•…äº‹ English Story</h4>
                            <div id="english-story-text" style="font-size: 18px;">
                                ${fullStoryEnglishSegments.map((segment, index) => 
                                    `<span id="english-segment-${index}" style="transition: all 0.3s ease;">${segment}</span>`
                                ).join(' ')}
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                            <button class="nav-btn" onclick="readFullStoryChinese()" id="chinese-story-btn" style="background: #ff6b6b; flex: 1; min-width: 140px;">
                                ğŸ”Š è¯»ä¸­æ–‡æ•…äº‹ Read Chinese Story
                            </button>
                            <button class="nav-btn" onclick="readFullStoryEnglish()" id="english-story-btn" style="background: #4CAF50; flex: 1; min-width: 140px;">
                                ğŸ”Š è¯»è‹±æ–‡æ•…äº‹ Read English Story
                            </button>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <button class="nav-btn" onclick="startGame()" style="margin: 5px;">ğŸ”„ å†ç©ä¸€æ¬¡ Play Again</button>
                        <button class="nav-btn" onclick="backToLearning()" style="margin: 5px;">ğŸ“– è¿”å›å­¦ä¹  Back to Learning</button>
                    </div>
                </div>
            `;
            document.getElementById('final-result').style.display = 'block';
        }

        // è¯»å®Œæ•´ä¸­æ–‡æ•…äº‹ï¼ˆå¸¦é«˜äº®ï¼Œæ­£å¸¸è¯­é€ŸæŒ‰å¥å­ï¼‰
        async function readFullStoryChinese() {
            const btn = document.getElementById('chinese-story-btn');
            const storyArea = document.getElementById('chinese-story-area');
            
            // æ˜¾ç¤ºæ•…äº‹æ–‡å­—
            storyArea.style.display = 'block';
            
            btn.style.background = '#45a049';
            btn.textContent = 'ğŸ”Š æ­£åœ¨æœ—è¯»ä¸­æ–‡æ•…äº‹...';
            btn.disabled = true;
            
            // é‡ç½®æ‰€æœ‰æ®µè½æ ·å¼
            resetHighlight('chinese');
            
            // é€å¥æœ—è¯»å¹¶é«˜äº®
            for (let i = 0; i < fullStorySegments.length; i++) {
                // é«˜äº®å½“å‰å¥å­
                highlightSegment('chinese', i, true);
                
                // ä»¥æ­£å¸¸è¯­é€Ÿæœ—è¯»å½“å‰å¥å­
                await speakStory(fullStorySegments[i], 'zh-CN');
                
                // å–æ¶ˆé«˜äº®
                highlightSegment('chinese', i, false);
                
                // çŸ­æš‚åœé¡¿
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            btn.style.background = '#ff6b6b';
            btn.textContent = 'ğŸ”Š è¯»ä¸­æ–‡æ•…äº‹ Read Chinese Story';
            btn.disabled = false;
        }

        // è¯»å®Œæ•´è‹±æ–‡æ•…äº‹ï¼ˆå¸¦é«˜äº®ï¼Œæ­£å¸¸è¯­é€ŸæŒ‰å¥å­ï¼‰
        async function readFullStoryEnglish() {
            const btn = document.getElementById('english-story-btn');
            const storyArea = document.getElementById('english-story-area');
            
            // æ˜¾ç¤ºæ•…äº‹æ–‡å­—
            storyArea.style.display = 'block';
            
            btn.style.background = '#388e3c';
            btn.textContent = 'ğŸ”Š Reading English Story...';
            btn.disabled = true;
            
            // é‡ç½®æ‰€æœ‰æ®µè½æ ·å¼
            resetHighlight('english');
            
            // é€å¥æœ—è¯»å¹¶é«˜äº®
            for (let i = 0; i < fullStoryEnglishSegments.length; i++) {
                // é«˜äº®å½“å‰å¥å­
                highlightSegment('english', i, true);
                
                // ä»¥æ­£å¸¸è¯­é€Ÿæœ—è¯»å½“å‰å¥å­
                await speakStory(fullStoryEnglishSegments[i], 'en-US');
                
                // å–æ¶ˆé«˜äº®
                highlightSegment('english', i, false);
                
                // çŸ­æš‚åœé¡¿
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            btn.style.background = '#4CAF50';
            btn.textContent = 'ğŸ”Š è¯»è‹±æ–‡æ•…äº‹ Read English Story';
            btn.disabled = false;
        }

        // é«˜äº®æŒ‡å®šæ®µè½
        function highlightSegment(language, index, highlight) {
            const segmentId = `${language}-segment-${index}`;
            const element = document.getElementById(segmentId);
            
            if (element) {
                if (highlight) {
                    element.style.backgroundColor = language === 'chinese' ? '#ffeb3b' : '#81c784';
                    element.style.color = '#333';
                    element.style.fontWeight = 'bold';
                    element.style.padding = '2px 4px';
                    element.style.borderRadius = '4px';
                    element.style.boxShadow = '0 2px 4px rgba(0,0,0,0.2)';
                } else {
                    element.style.backgroundColor = 'transparent';
                    element.style.color = '#333';
                    element.style.fontWeight = 'normal';
                    element.style.padding = '0';
                    element.style.borderRadius = '0';
                    element.style.boxShadow = 'none';
                }
            }
        }

        // é‡ç½®æ‰€æœ‰æ®µè½é«˜äº®
        function resetHighlight(language) {
            const segments = language === 'chinese' ? fullStorySegments : fullStoryEnglishSegments;
            for (let i = 0; i < segments.length; i++) {
                highlightSegment(language, i, false);
            }
        }

        // åˆå§‹åŒ– - ç­‰å¾…è¯­éŸ³åº“åŠ è½½
        window.addEventListener('load', () => {
            // ç¡®ä¿è¯­éŸ³åº“åŠ è½½å®Œæˆ
            if ('speechSynthesis' in window) {
                speechSynthesis.getVoices();
                // ç›‘å¬è¯­éŸ³åº“åŠ è½½å®Œæˆäº‹ä»¶
                speechSynthesis.onvoiceschanged = () => {
                    console.log('è¯­éŸ³åº“åŠ è½½å®Œæˆ');
                };
            }
            loadVocabPage();
        });
    </script>
</body>
</html>